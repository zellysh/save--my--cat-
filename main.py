@namespace
class SpriteKind:
    physicsObject = SpriteKind.create()
    FanGust = SpriteKind.create()
    GroundFan = SpriteKind.create()
    Cursor = SpriteKind.create()
    boss = SpriteKind.create()
    EnemyProj = SpriteKind.create()

def on_up_pressed():
    global inAir, gliding, rune
    if rune == 0:
        if mySprite.is_hitting_tile(CollisionDirection.BOTTOM):
            inAir = 1
            mySprite.vy = -135
            animation.run_image_animation(mySprite, animationJumping, 50, False)
        else:
            if not (tiles.tile_at_location_is_wall(mySprite.tilemap_location().get_neighboring_location(CollisionDirection.BOTTOM))) and (not (tiles.tile_at_location_is_wall(mySprite.tilemap_location().get_neighboring_location(CollisionDirection.BOTTOM).get_neighboring_location(CollisionDirection.BOTTOM))) and not (tiles.tile_at_location_is_wall(mySprite.tilemap_location().get_neighboring_location(CollisionDirection.BOTTOM).get_neighboring_location(CollisionDirection.BOTTOM).get_neighboring_location(CollisionDirection.BOTTOM)))) and gliding == 0:
                animation.run_image_animation(mySprite, animationPullOutGlider, 50, False)
                pause(300)
                gliding = 1
            elif gliding == 1:
                gliding = 0
                animation.stop_animation(animation.AnimationTypes.ALL, mySprite)
                mySprite.set_image(img("""
                    . 5 5 5 5 5 . 
                                        5 4 4 4 4 5 . 
                                        . 4 4 4 f . . 
                                        . 4 4 4 4 . . 
                                        . . 7 6 . . . 
                                        . . 6 7 . . . 
                                        . 4 7 7 . . . 
                                        . . 8 8 . . . 
                                        . 6 8 8 8 . . 
                                        6 6 6 8 8 8 . 
                                        e e . . 8 f f 
                                        . e e . f f .
                """))
                if direction == 1:
                    mySprite.image.flip_x()
                mySprite.y += 4
            else:
                pass
    elif rune == 2:
        inAir = 1
        mySprite.vy = -135
        animation.run_image_animation(mySprite, animationJumping, 50, False)
        scene.set_background_image(img("""
            ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
        """))
        rune = 0
        mySprite.vx = 0
        mySprite.ax = 0
        mySprite.ay = 500
        controller.move_sprite(mySprite, 100, 0)
controller.up.on_event(ControllerButtonEvent.PRESSED, on_up_pressed)

def loadMap():
    global inAir, gliding, dinosaur, mounted, object3
    mySprite.set_image(img("""
        . . . 5 5 5 5 5 5 . . . 
                . . 5 4 4 4 4 5 . . . . 
                . . . 4 4 4 f . . . . . 
                . . . 4 4 4 4 . . . . . 
                . . . . 7 6 . . . . . . 
                . . . . 7 6 . . . . . . 
                . . . . 7 4 . . . . . . 
                . . . . 7 7 . . . . . . 
                . . . . 8 8 . . . . . . 
                . . . . 8 8 . . . . . . 
                . . . . 8 8 . . . . . . 
                . . . . f f f . . . . .
    """))
    animation.stop_animation(animation.AnimationTypes.ALL, mySprite)
    inAir = 0
    gliding = 0
    sprites.destroy_all_sprites_of_kind(SpriteKind.food)
    sprites.destroy_all_sprites_of_kind(SpriteKind.projectile)
    sprites.destroy_all_sprites_of_kind(SpriteKind.enemy)
    sprites.destroy_all_sprites_of_kind(SpriteKind.GroundFan)
    sprites.destroy_all_sprites_of_kind(SpriteKind.FanGust)
    sprites.destroy_all_sprites_of_kind(SpriteKind.physicsObject)
    for value in tiles.get_tiles_by_type(assets.tile("""
        myTile27
    """)):
        dinosaur = sprites.create(img("""
                . 7 7 7 7 . . . . . . . . . . . 
                            7 7 7 7 7 7 . . . . . . . . . . 
                            7 f 7 7 7 7 . . . . . . . . . . 
                            7 7 7 7 7 7 . . . . . . . . . . 
                            1 1 7 7 7 7 . . . . . . . . . . 
                            . 7 7 7 7 . . . . . . . . . . . 
                            . . 7 7 . . . . . . . . . . 6 . 
                            . . 7 7 . . . . . . . . . . 7 . 
                            . . 7 7 7 . 6 . . . . . . . 7 . 
                            7 . 7 7 7 7 7 . 6 . . 6 . 7 7 . 
                            . 7 . 7 7 7 7 7 7 . . 7 7 7 . . 
                            7 . . 7 7 7 7 7 7 7 7 7 7 . . . 
                            . . . . 7 7 7 7 7 7 7 7 . . . . 
                            . . . . . . . 7 7 . . . . . . . 
                            . . . . . . . 7 7 . . . . . . . 
                            . . . . . . 7 7 7 . . . . . . .
            """),
            SpriteKind.enemy)
        dinosaur.vx = -10
        dinosaur.ay = 500
        dinosaur.set_position(value.x, value.y)
        tiles.set_tile_at(value, assets.tile("""
            transparency8
        """))
        animation.run_image_animation(dinosaur,
            [img("""
                    . 7 7 7 7 . . . . . . . . . . . 
                                7 7 7 7 7 7 . . . . . . . . . . 
                                7 f 7 7 7 7 . . . . . . . . . . 
                                7 7 7 7 7 7 . . . . . . . . . . 
                                1 1 7 7 7 7 . . . . . . . . . . 
                                . 7 7 7 7 . . . . . . . . . . . 
                                . . 7 7 . . . . . . . . . . 6 . 
                                . . 7 7 . . . . . . . . . . 7 . 
                                . . 7 7 7 . 6 . . . . . . . 7 . 
                                7 . 7 7 7 7 7 . 6 . . 6 . 7 7 . 
                                . 7 . 7 7 7 7 7 7 . . 7 7 7 . . 
                                7 . . 7 7 7 7 7 7 7 7 7 7 . . . 
                                . . . . 7 7 7 7 7 7 7 7 . . . . 
                                . . . . . . . 7 7 . . . . . . . 
                                . . . . . . . 7 7 . . . . . . . 
                                . . . . . . 7 7 7 . . . . . . .
                """),
                img("""
                    . 7 7 7 7 . . . . . . . . . . . 
                                7 7 7 7 7 7 . . . . . . . . . . 
                                7 f 7 7 7 7 . . . . . . . . . . 
                                7 7 7 7 7 7 . . . . . . . . . . 
                                1 1 7 7 7 7 . . . . . . . . . . 
                                . 7 7 7 7 . . . . . . . . . . . 
                                . . 7 7 . . . . . . . . . . 6 . 
                                . . 7 7 . . . . . . . . . . 7 . 
                                . . 7 7 7 . 6 . . . . . . . 7 . 
                                7 . 7 7 7 7 7 . 6 . . 6 . 7 7 . 
                                . 7 . 7 7 7 7 7 7 . . 7 7 7 . . 
                                7 . . 7 7 7 7 7 7 7 7 7 7 . . . 
                                . . . . 7 7 7 7 7 7 7 7 . . . . 
                                . . . . . . 7 7 6 6 . . . . . . 
                                . . . . 7 . 7 7 . 6 6 . . . . . 
                                . . . . . 7 7 . 6 6 6 . . . . .
                """),
                img("""
                    . 7 7 7 7 . . . . . . . . . . . 
                                7 7 7 7 7 7 . . . . . . . . . . 
                                7 f 7 7 7 7 . . . . . . . . . . 
                                7 7 7 7 7 7 . . . . . . . . . . 
                                1 1 7 7 7 7 . . . . . . . . . . 
                                . 7 7 7 7 . . . . . . . . . . . 
                                . . 7 7 . . . . . . . . . . 6 . 
                                . . 7 7 . . . . . . . . . . 7 . 
                                . . 7 7 7 . 6 . . . . . . . 7 . 
                                7 . 7 7 7 7 7 . 6 . . 6 . 7 7 . 
                                . 7 . 7 7 7 7 7 7 . . 7 7 7 . . 
                                7 . . 7 7 7 7 7 7 7 7 7 7 . . . 
                                . . . . 7 7 7 7 7 7 7 7 . . . . 
                                . . . . . . . 7 7 . . . . . . . 
                                . . . . . . . 7 7 . . . . . . . 
                                . . . . . . 7 7 7 . . . . . . .
                """),
                img("""
                    . 7 7 7 7 . . . . . . . . . . . 
                                7 7 7 7 7 7 . . . . . . . . . . 
                                7 f 7 7 7 7 . . . . . . . . . . 
                                7 7 7 7 7 7 . . . . . . . . . . 
                                1 1 7 7 7 7 . . . . . . . . . . 
                                . 7 7 7 7 . . . . . . . . . . . 
                                . . 7 7 . . . . . . . . . . 6 . 
                                . . 7 7 . . . . . . . . . . 7 . 
                                . . 7 7 7 . 6 . . . . . . . 7 . 
                                7 . 7 7 7 7 7 . 6 . . 6 . 7 7 . 
                                . 7 . 7 7 7 7 7 7 . . 7 7 7 . . 
                                7 . . 7 7 7 7 7 7 7 7 7 7 . . . 
                                . . . . 7 7 7 7 7 7 7 7 . . . . 
                                . . . . . . 6 6 7 7 . . . . . . 
                                . . . . 6 . 6 6 . 7 7 . . . . . 
                                . . . . . 6 6 . 7 7 7 . . . . .
                """)],
            500,
            True)
    mounted = False
    for value2 in sprites.all_of_kind(SpriteKind.physicsObject):
        value2.x += 128
    tileUtil.create_sprites_on_tiles(assets.tile("""
            myTile29
        """),
        img("""
            .
        """),
        SpriteKind.GroundFan)
    for value3 in sprites.all_of_kind(SpriteKind.GroundFan):
        value3.set_flag(SpriteFlag.GHOST, True)
    for value4 in tiles.get_tiles_by_type(assets.tile("""
        myTile35
    """)):
        object3 = sprites.create(img("""
                ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            .66666666666666666666666666666666666666666666666666666666666666.
                            6666666666666666666666666666666666666666666666666666666666666666
                            6666666666666666666666666666666666666666666666666666666666666666
                            .66666666666666666666666666666666666666666666666666666666666666.
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
                            ................................................................
            """),
            SpriteKind.physicsObject)
        object3.ay = 500
        sprites.set_data_string(object3, "type", "platform")
        object3.set_position(value4.x, value4.y)
        tiles.set_tile_at(value4, assets.tile("""
            transparency8
        """))
    for value5 in tiles.get_tiles_by_type(assets.tile("""
        myTile33
    """)):
        object3 = sprites.create(img("""
                . . . . . . . . . . . . . . . . 
                            . . . . . . . . . . . . . . . . 
                            . . . . . . . . . . . . . . . . 
                            . . . . . . . . . . . . . . . . 
                            . . . . . . . 6 6 . . . . . . . 
                            . . . . . . 6 6 6 6 . . . . . . 
                            . b 1 b b 1 b b b b 1 b b 1 b . 
                            b 1 b b 1 b b 1 b b b 1 b b 1 b 
                            b 1 b b 1 b b 1 b b b 1 b b 1 b 
                            . b 1 b b 1 b b b b 1 b b 1 b . 
                            . . . . . . . 7 7 . . . . . . . 
                            . . . . . . . . . . . . . . . . 
                            . . . . . . . . . . . . . . . . 
                            . . . . . . . . . . . . . . . . 
                            . . . . . . . . . . . . . . . . 
                            . . . . . . . . . . . . . . . .
            """),
            SpriteKind.physicsObject)
        object3.ay = 500
        sprites.set_data_string(object3, "type", "fan")
        object3.set_position(value5.x, value5.y)
        tiles.set_tile_at(value5, assets.tile("""
            transparency8
        """))
    for value6 in tiles.get_tiles_by_type(assets.tile("""
        myTile37
    """)):
        object3 = sprites.create(img("""
                ..................
                            ..................
                            ..................
                            ...7..........7...
                            ..................
                            ..7............7..
                            ..................
                            ..7............7..
                            ..................
                            ..7............7..
                            ..................
                            ..7ffffffffffff7..
                            ..ff6666666666ff..
                            ..f666666666666f..
                            ..ff6666666666ff..
                            ...ffffffffffff...
                            ..................
                            ..................
            """),
            SpriteKind.physicsObject)
        object3.ay = 500
        sprites.set_data_string(object3, "type", "controller (empty)")
        object3.set_position(value6.x, value6.y)
        tiles.set_tile_at(value6, assets.tile("""
            transparency8
        """))
    for value7 in tiles.get_tiles_by_type(assets.tile("""
        myTile38
    """)):
        object3 = sprites.create(img("""
                . . . . . . . . . . . . 
                            . . f f f f f f f f . . 
                            . f f f f f f f f f f . 
                            f f f f f f f f f f f f 
                            f f 6 8 8 8 8 8 8 6 f f 
                            f 6 6 8 8 8 8 8 8 6 6 f 
                            . 6 6 8 8 8 8 8 8 6 6 . 
                            . 6 6 6 8 8 8 8 6 6 6 . 
                            . . 6 6 6 6 6 6 6 6 . . 
                            . . . 6 6 6 6 6 6 . . .
            """),
            SpriteKind.physicsObject)
        object3.ay = 500
        sprites.set_data_string(object3, "type", "wheel")
        sprites.set_data_boolean(object3, "hittingWall", False)
        object3.set_position(value7.x, value7.y)
        tiles.set_tile_at(value7, assets.tile("""
            transparency8
        """))
    for value8 in tiles.get_tiles_by_type(assets.tile("""
        myTile36
    """)):
        object3 = sprites.create(img("""
                . . . . . . . 2 2 . . . . . . . 
                            . . . . . . 2 f f 2 . . . . . . 
                            . . . . . . f f f f . . . . . . 
                            . . . . . . f f f f . . . . . . 
                            . . . . . . f f f f . . . . . . 
                            . . . . . . f 2 2 f . . . . . . 
                            . . . . . . 2 f f 2 . . . . . . 
                            . . . . . f f c c f f . . . . . 
                            . . . . f f f c c f f f . . . . 
                            . . . f f f f c c f f f f . . . 
                            . . . f f f f a a f f f f . . . 
                            . . . f f f f c c f f f f . . . 
                            . . . . f f f f f f f f . . . . 
                            . . . . . . 6 6 6 6 . . . . . . 
                            . . . . . . 6 6 6 6 . . . . . . 
                            . . . . . . . 6 6 . . . . . . .
            """),
            SpriteKind.physicsObject)
        object3.ay = 500
        sprites.set_data_string(object3, "type", "rocket")
        object3.set_position(value8.x, value8.y)
        tiles.set_tile_at(value8, assets.tile("""
            transparency8
        """))
    if blockSettings.read_number("finalBossComplete") == 1:
        for value9 in tiles.get_tiles_by_type(assets.tile("""
            myTile39
        """)):
            tiles.set_tile_at(value9, assets.tile("""
                transparency8
            """))
        for value10 in tiles.get_tiles_by_type(assets.tile("""
            myTile42
        """)):
            tiles.set_tile_at(value10, assets.tile("""
                transparency8
            """))
        for value11 in tiles.get_tiles_by_type(assets.tile("""
            myTile43
        """)):
            tiles.set_tile_at(value11, assets.tile("""
                transparency8
            """))
        for value12 in tiles.get_tiles_by_type(assets.tile("""
            myTile44
        """)):
            tiles.set_tile_at(value12, assets.tile("""
                transparency8
            """))
        for value13 in tiles.get_tiles_by_type(assets.tile("""
            myTile45
        """)):
            tiles.set_tile_at(value13, assets.tile("""
                transparency8
            """))
        for value14 in tiles.get_tiles_by_type(assets.tile("""
            myTile46
        """)):
            tiles.set_tile_at(value14, assets.tile("""
                transparency8
            """))
        for value15 in tiles.get_tiles_by_type(assets.tile("""
            myTile47
        """)):
            tiles.set_tile_at(value15, assets.tile("""
                transparency8
            """))
    else:
        for value16 in tiles.get_tiles_by_type(assets.tile("""
            myTile41
        """)):
            tiles.set_tile_at(value16, assets.tile("""
                transparency16
            """))
def holdObject(object2: Sprite):
    global partOfObject, holdingState, connect, rune, branches
    if rune == 1:
        partOfObject = False
        for value17 in allConnections:
            if value17.index(object2) > 0:
                value17.unshift(value17.remove_at(value17.index(object2)))
            if value17.index(object2) >= 0:
                partOfObject = True
        if controller.A.is_pressed():
            if not (controller.B.is_pressed()):
                holdingState = 0
                for value18 in sprites.all_of_kind(SpriteKind.physicsObject):
                    if overlapsWithArray(object2, value18):
                        connect = True
                        for value22 in allConnections:
                            if value22.index(object2) != -1 and value22.index(value18) != -1:
                                connect = False
                        if connect:
                            allConnections.append([])
                            for value23 in allConnections:
                                if value23.index(object2) != -1:
                                    for value32 in value23:
                                        if value32 != object2:
                                            allConnections[len(allConnections) - 1].append(value32)
                                            sprites.set_data_number(value32, "offsetX", Math.round(value32.x - object2.x))
                                            sprites.set_data_number(value32, "offsetY", Math.round(value32.y - object2.y))
                                    allConnections.remove_at(allConnections.index(value23))
                                    break
                            for value24 in allConnections:
                                if value24.index(value18) != -1:
                                    for value33 in value24:
                                        if value33 != value18:
                                            allConnections[len(allConnections) - 1].append(value33)
                                            sprites.set_data_number(value33, "offsetX", Math.round(value33.x - object2.x))
                                            sprites.set_data_number(value33, "offsetY", Math.round(value33.y - object2.y))
                                    allConnections.remove_at(allConnections.index(value24))
                                    break
                            allConnections[len(allConnections) - 1].unshift(value18)
                            allConnections[len(allConnections) - 1].unshift(object2)
                            sprites.set_data_number(object2, "offsetX", 0)
                            sprites.set_data_number(object2, "offsetY", 0)
                            sprites.set_data_number(value18, "offsetX", Math.round(value18.x - object2.x))
                            sprites.set_data_number(value18, "offsetY", Math.round(value18.y - object2.y))
                            break
                sprites.destroy(cursor)
                object2.ay = 500
                controller.move_sprite(object2, 0, 0)
                object2.set_flag(SpriteFlag.STAY_IN_SCREEN, False)
                
                def on_pause_until():
                    pass
                pause_until(on_pause_until)
                
                rune = 0
                return
            else:
                holdingState = 0
                branches = []
                for value19 in allConnections:
                    if value19.index(object2) != -1:
                        for value25 in value19:
                            if value25.overlaps_with(object2):
                                branches.append([value25])
                                sprites.set_data_number(value25, "offsetX", 0)
                                sprites.set_data_number(value25, "offsetY", 0)
                                index = 0
                                while index <= len(value19) - 1:
                                    for value34 in value19:
                                        for value42 in branches[len(branches) - 1]:
                                            if value34.overlaps_with(value42):
                                                if branches[len(branches) - 1].index(value34) == -1 and value34 != object2:
                                                    branches[len(branches) - 1].append(value34)
                                                    sprites.set_data_number(value34, "offsetX", Math.round(value34.x - value25.x))
                                                    sprites.set_data_number(value34, "offsetY", Math.round(value34.y - value25.y))
                                    index += 1
                                for value35 in branches:
                                    if len(value35) == len(branches[len(branches) - 1]) and branches[len(branches) - 1] != value35:
                                        for value43 in value35:
                                            if branches[len(branches) - 1].index(value43) == -1:
                                                break
                                            if value43 == branches[len(branches) - 1][len(branches[len(branches) - 1]) - 1]:
                                                branches.remove_at(branches.index(value35))
                        allConnections.remove_at(allConnections.index(value19))
                for value26 in branches:
                    if len(value26) > 1:
                        allConnections.append(value26)
                    else:
                        value26[0].ay = 500
                        controller.move_sprite(value26[0], 0, 0)
                        value26[0].set_flag(SpriteFlag.STAY_IN_SCREEN, False)
                sprites.destroy(cursor)
                object2.ay = 500
                controller.move_sprite(object2, 0, 0)
                object2.set_flag(SpriteFlag.STAY_IN_SCREEN, False)
                
                def on_pause_until2():
                    pass
                pause_until(on_pause_until2)
                
                rune = 0
                return
        cursor.set_position(object2.x, object2.y)
        object2.ay = 0
        if controller.left.is_pressed():
            object2.x += -0.5
        if controller.right.is_pressed():
            object2.x += 0.5
        if controller.up.is_pressed():
            object2.y += -0.5
        if controller.down.is_pressed():
            object2.y += 0.5
        if controller.B.is_pressed() and not (partOfObject):
            if controller.left.is_pressed():
                transformSprites.change_rotation(object2, -45)
                
                def on_pause_until3():
                    pass
                pause_until(on_pause_until3)
                
            if controller.right.is_pressed():
                transformSprites.change_rotation(object2, 45)
                
                def on_pause_until4():
                    pass
                pause_until(on_pause_until4)
                
        
        def on_background():
            pause(0)
            holdObject(object2)
        timer.background(on_background)
        

def on_b_pressed():
    global selectedBlock, posX, posY, rune, gliding
    if rune == 0 and not (mounted):
        if len(tiles.get_tiles_by_type(assets.tile("""
            myTile28
        """))) > 0:
            selectedBlock = tiles.get_tiles_by_type(assets.tile("""
                myTile28
            """))[0]
            if mySprite.vx > 0:
                posX = mySprite.x + 64
            elif mySprite.vx < 0:
                posX = mySprite.x - 64
            else:
                posX = mySprite.x
            posY = mySprite.y - 32
            for value20 in tiles.get_tiles_by_type(assets.tile("""
                myTile28
            """)):
                if selectedBlock:
                    if Math.sqrt((posX - value20.x) ** 2 + (posY - value20.y) ** 2) < 128 and Math.sqrt((posX - value20.x) ** 2 + (posY - value20.y) ** 2) < Math.sqrt((posX - selectedBlock.x) ** 2 + (posY - selectedBlock.y) ** 2):
                        selectedBlock = value20
                else:
                    selectedBlock = value20
            if Math.sqrt((posX - selectedBlock.x) ** 2 + (posY - selectedBlock.y) ** 2) < 128:
                rune = 2
                gliding = 0
                mySprite.set_image(img("""
                    . . . 5 5 5 5 5 5 . . . 
                                        . . 5 4 4 4 4 5 . . . . 
                                        . . . 4 4 4 f . . . . . 
                                        . . . 4 4 4 4 . . . . . 
                                        . . . . 7 6 . . . . . . 
                                        . . . . 7 6 . . . . . . 
                                        . . . . 7 4 . . . . . . 
                                        . . . . 7 7 . . . . . . 
                                        . . . . 8 8 . . . . . . 
                                        . . . . 8 8 . . . . . . 
                                        . . . . 8 8 . . . . . . 
                                        . . . . f f f . . . . .
                """))
                if direction == 0:
                    mySprite.image.flip_x()
                controller.move_sprite(mySprite, 0, 0)
    elif rune == 2:
        scene.set_background_image(img("""
            ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
        """))
        rune = 0
        mySprite.vx = 0
        mySprite.ax = 0
        mySprite.ay = 500
        controller.move_sprite(mySprite, 100, 0)
controller.B.on_event(ControllerButtonEvent.PRESSED, on_b_pressed)

def on_hit_wall(sprite, location):
    for value21 in allConnections:
        if value21.index(sprite) != -1:
            for value27 in value21:
                sprites.set_data_number(value27, "constructGravity", 0)
scene.on_hit_wall(SpriteKind.physicsObject, on_hit_wall)

def on_overlap_tile(sprite2, location2):
    global area
    tiles.set_current_tilemap(tileUtil.create_small_map(tilemap("""
        level1
    """)))
    info.set_life(blockSettings.read_number("maxHealth"))
    area = 0
    loadMap()
    tiles.place_on_tile(mySprite, prevPos)
scene.on_overlap_tile(SpriteKind.player,
    assets.tile("""
        myTile34
    """),
    on_overlap_tile)

def on_overlap_tile2(sprite3, location3):
    global list2, area
    tiles.set_current_tilemap(tileUtil.create_small_map(tilemap("""
        level1
    """)))
    list2 = blockSettings.read_number_array("areasCleared")
    list2.append(area)
    blockSettings.write_number_array("areasCleared", list2)
    blockSettings.write_number("maxHealth", blockSettings.read_number("maxHealth") + 1)
    info.set_life(blockSettings.read_number("maxHealth"))
    mySprite.x += 0
    area = 0
    loadMap()
    tiles.place_on_tile(mySprite, prevPos)
scene.on_overlap_tile(SpriteKind.player,
    assets.tile("""
        myTile32
    """),
    on_overlap_tile2)

def on_a_pressed():
    global projectile, rune
    if not (mounted):
        if rune == 0:
            if direction == 0:
                projectile = sprites.create_projectile_from_sprite(img("""
                        . . . . . . . 1 1 . . . 
                                            . . . . . . . . 1 1 . . 
                                            . . . . . . . . . 1 1 . 
                                            . . . . . . . . . . 1 1 
                                            . . . . . . . . . . 1 1 
                                            . . . . . . . . . . 1 1 
                                            . . . . . . . . . . 1 1 
                                            . . . . . . . . . . 1 1 
                                            . . . . . . . . . . 1 1 
                                            . . . . . . . . . 1 1 . 
                                            . . . . . . . . 1 1 . . 
                                            . . . . . . . 1 1 . . .
                    """),
                    mySprite,
                    0,
                    0)
                projectile.x += 10
                projectile.set_flag(SpriteFlag.AUTO_DESTROY, True)
                projectile.set_flag(SpriteFlag.DESTROY_ON_WALL, True)
                animation.run_image_animation(projectile,
                    [img("""
                            . . . . 1 1 . 1 1 . . . 
                                                . . . 1 d 1 . . 1 . . . 
                                                . . 1 d 1 . . . . . . . 
                                                . e 1 1 . . . . . . . . 
                                                . e e . . . . . . . . . 
                                                e . . . . . . . . . . . 
                                                . . . . . . . . . . . . 
                                                . . . . . . . . . . . . 
                                                . . . . . . . . . . . . 
                                                . . . . . . . . . . . . 
                                                . . . . . . . . . . . . 
                                                . . . . . . . . . . . .
                        """),
                        img("""
                            . . . . . . . 1 1 . . . 
                                                . . . . . . . . 1 1 . . 
                                                . . . . . . . . . 1 1 . 
                                                . . . . . . . . . . 1 1 
                                                . . . . . . . . . . 1 1 
                                                . . 1 1 1 1 1 . . . 1 1 
                                                e e 1 d d d d 1 . . 1 1 
                                                . . 1 1 1 1 1 . . . 1 . 
                                                . . . . . . . . . . . . 
                                                . . . . . . . . . . . . 
                                                . . . . . . . . . . . . 
                                                . . . . . . . . . . . .
                        """),
                        img("""
                            . . . . . . . 1 1 . . . 
                                                . . . . . . . . 1 1 . . 
                                                . . . . . . . . . 1 1 . 
                                                . . . . . . . . . . 1 1 
                                                . . . . . . . . . . 1 1 
                                                . . . . . . . . . . 1 1 
                                                e . . . . . . . . . 1 1 
                                                . e e . . . . . . . 1 1 
                                                . e 1 1 . . . . . . 1 1 
                                                . . 1 1 1 . . . . 1 1 . 
                                                . . . 1 1 1 . . 1 1 . . 
                                                . . . . 1 1 . 1 1 . . .
                        """),
                        img("""
                            . . . . . . . 1 1 . . . 
                                                . . . . . . . . 1 1 . . 
                                                . . . . . . . . . 1 1 . 
                                                . . . . . . . . . . 1 1 
                                                . . . . . . . . . . 1 1 
                                                . . . . . . . . . . 1 1 
                                                . . . . . . . . . . 1 1 
                                                . . . . . . . . . . 1 1 
                                                . . . . . . . . . . 1 1 
                                                . . . . . . . . . 1 1 . 
                                                . . . . . . . . 1 1 . . 
                                                . . . . . . . 1 1 . . .
                        """)],
                    50,
                    False)
                
                def on_after():
                    projectile.vx = 50
                timer.after(150, on_after)
                
            else:
                projectile = sprites.create_projectile_from_sprite(img("""
                        . . . 1 1 . . . . . . . 
                                            . . 1 1 . . . . . . . . 
                                            . 1 1 . . . . . . . . . 
                                            1 1 . . . . . . . . . . 
                                            1 1 . . . . . . . . . . 
                                            1 1 . . . . . . . . . . 
                                            1 1 . . . . . . . . . . 
                                            1 1 . . . . . . . . . . 
                                            1 1 . . . . . . . . . . 
                                            . 1 1 . . . . . . . . . 
                                            . . 1 1 . . . . . . . . 
                                            . . . 1 1 . . . . . . .
                    """),
                    mySprite,
                    0,
                    0)
                projectile.x += -10
                projectile.set_flag(SpriteFlag.AUTO_DESTROY, True)
                projectile.set_flag(SpriteFlag.DESTROY_ON_WALL, True)
                animation.run_image_animation(projectile,
                    [img("""
                            . . . 1 1 . 1 1 . . . . 
                                                . . . 1 . . 1 d 1 . . . 
                                                . . . . . . . 1 d 1 . . 
                                                . . . . . . . . 1 1 e . 
                                                . . . . . . . . . e e . 
                                                . . . . . . . . . . . e 
                                                . . . . . . . . . . . . 
                                                . . . . . . . . . . . . 
                                                . . . . . . . . . . . . 
                                                . . . . . . . . . . . . 
                                                . . . . . . . . . . . . 
                                                . . . . . . . . . . . .
                        """),
                        img("""
                            . . . 1 1 . . . . . . . 
                                                . . 1 1 . . . . . . . . 
                                                . 1 1 . . . . . . . . . 
                                                1 1 . . . . . . . . . . 
                                                1 1 . . . . . . . . . . 
                                                1 1 . . . 1 1 1 1 1 . . 
                                                1 1 . . 1 d d d d 1 e e 
                                                . 1 . . . 1 1 1 1 1 . . 
                                                . . . . . . . . . . . . 
                                                . . . . . . . . . . . . 
                                                . . . . . . . . . . . . 
                                                . . . . . . . . . . . .
                        """),
                        img("""
                            . . . 1 1 . . . . . . . 
                                                . . 1 1 . . . . . . . . 
                                                . 1 1 . . . . . . . . . 
                                                1 1 . . . . . . . . . . 
                                                1 1 . . . . . . . . . . 
                                                1 1 . . . . . . . . . . 
                                                1 1 . . . . . . . . . e 
                                                1 1 . . . . . . . e e . 
                                                1 1 . . . . . . 1 1 e . 
                                                . 1 1 . . . . 1 1 1 . . 
                                                . . 1 1 . . 1 1 1 . . . 
                                                . . . 1 1 . 1 1 . . . .
                        """),
                        img("""
                            . . . 1 1 . . . . . . . 
                                                . . 1 1 . . . . . . . . 
                                                . 1 1 . . . . . . . . . 
                                                1 1 . . . . . . . . . . 
                                                1 1 . . . . . . . . . . 
                                                1 1 . . . . . . . . . . 
                                                1 1 . . . . . . . . . . 
                                                1 1 . . . . . . . . . . 
                                                1 1 . . . . . . . . . . 
                                                . 1 1 . . . . . . . . . 
                                                . . 1 1 . . . . . . . . 
                                                . . . 1 1 . . . . . . .
                        """)],
                    50,
                    False)
                
                def on_after2():
                    projectile.vx = -50
                timer.after(150, on_after2)
                
        elif rune == 1:
            if controller.B.is_pressed():
                if holdingState == 0:
                    sprites.destroy(cursor)
                    for value28 in sprites.all_of_kind(SpriteKind.physicsObject):
                        value28.ay = 500
                        controller.move_sprite(value28, 0, 0)
                        value28.set_flag(SpriteFlag.STAY_IN_SCREEN, False)
                    rune = 0
                
                def on_pause_until5():
                    pass
                pause_until(on_pause_until5)
                
controller.A.on_event(ControllerButtonEvent.PRESSED, on_a_pressed)

def on_overlap_tile3(sprite4, location4):
    
    def on_throttle():
        info.change_life_by(-1)
    timer.throttle("idk", 500, on_throttle)
    
scene.on_overlap_tile(SpriteKind.player,
    assets.tile("""
        myTile7
    """),
    on_overlap_tile3)

def on_on_overlap(sprite5, otherSprite):
    global gliding
    if rune == 0 and gliding == 0:
        animation.run_image_animation(mySprite, animationPullOutGlider, 50, False)
        pause(300)
        gliding = 1
        mySprite.vy = -135
    else:
        if mySprite.vy > 0:
            mySprite.vy = 0
        if mySprite.vy > -150:
            mySprite.vy += -40
sprites.on_overlap(SpriteKind.player, SpriteKind.FanGust, on_on_overlap)

def on_combos_attach_combo():
    if rune == 0 and not (mounted):
        initiateHand()
controller.combos.attach_combo("" + controller.combos.id_to_string(controller.combos.ID.DOWN) + controller.combos.id_to_string(controller.combos.ID.DOWN),
    on_combos_attach_combo)

def on_on_overlap2(sprite6, otherSprite2):
    if info.life() < blockSettings.read_number("maxHealth"):
        info.change_life_by(1)
        sprites.destroy(sprite6)
sprites.on_overlap(SpriteKind.food, SpriteKind.player, on_on_overlap2)

def on_overlap_tile4(sprite7, location5):
    global prevPos, area, list2
    if (mySprite.tile_kind_at(TileDirection.CENTER, assets.tile("""
        myTile16
    """)) or mySprite.tile_kind_at(TileDirection.TOP, assets.tile("""
        myTile16
    """))) and rune == 0:
        mySprite.say_text("Press A to interact", 50, False)
        if controller.A.is_pressed():
            if mySprite.tilemap_location().column == 22:
                prevPos = mySprite.tilemap_location()
                tiles.set_current_tilemap(tileUtil.create_small_map(tilemap("""
                    level5
                """)))
                tiles.place_on_tile(mySprite, tiles.get_tile_location(2, 10))
                area = 1
                loadMap()
            elif mySprite.tilemap_location().column == 139:
                prevPos = mySprite.tilemap_location()
                tiles.set_current_tilemap(tileUtil.create_small_map(tilemap("""
                    level14
                """)))
                tiles.place_on_tile(mySprite, tiles.get_tile_location(2, 28))
                area = 2
                loadMap()
            elif mySprite.tilemap_location().column == 64:
                prevPos = mySprite.tilemap_location()
                tiles.set_current_tilemap(tileUtil.create_small_map(tilemap("""
                    level18
                """)))
                tiles.place_on_tile(mySprite, tiles.get_tile_location(2, 10))
                area = 3
                loadMap()
            elif mySprite.tilemap_location().column == 220:
                prevPos = mySprite.tilemap_location()
                tiles.set_current_tilemap(tileUtil.create_small_map(tilemap("""
                    level23
                """)))
                tiles.place_on_tile(mySprite, tiles.get_tile_location(2, 124))
                area = 4
                loadMap()
            elif mySprite.tilemap_location().column == 140:
                prevPos = mySprite.tilemap_location()
                tiles.set_current_tilemap(tileUtil.create_small_map(tilemap("""
                    level26
                """)))
                tiles.place_on_tile(mySprite, tiles.get_tile_location(2, 60))
                area = 5
                loadMap()
            else:
                pass
            list2 = blockSettings.read_number_array("areasCleared")
            if list2.index(area) != -1:
                tileUtil.replace_all_tiles(assets.tile("""
                        myTile32
                    """),
                    assets.tile("""
                        myTile34
                    """))
            
            def on_pause_until6():
                pass
            pause_until(on_pause_until6)
            
scene.on_overlap_tile(SpriteKind.player,
    assets.tile("""
        myTile16
    """),
    on_overlap_tile4)

def on_hit_wall2(sprite8, location6):
    pass
scene.on_hit_wall(SpriteKind.enemy, on_hit_wall2)

def on_on_overlap3(sprite9, otherSprite3):
    
    def on_throttle2():
        info.change_life_by(-1)
    timer.throttle("idk", 500, on_throttle2)
    
sprites.on_overlap(SpriteKind.enemy, SpriteKind.player, on_on_overlap3)

def initiateHand():
    global rune, cursor
    rune = 1
    cursor = sprites.create(img("""
            . . 1 . . 
                    . . 1 . . 
                    1 1 1 1 1 
                    . . 1 . . 
                    . . 1 . .
        """),
        SpriteKind.Cursor)
    controller.move_sprite(cursor)
    cursor.set_stay_in_screen(True)

def on_add_handler_update_priority_modifier_before_camera():
    global finalX, finalY, loop
    for value29 in allConnections:
        finalX = 0
        finalY = 0
        for value210 in value29:
            if sprites.read_data_string(value210, "type") == "controller (occupied)":
                finalX = velocityChangeX
                finalY = velocityChangeY
            value210.ax = 0
            value210.ay = 0
            value210.vx = 0
            value210.vy = 0
        if velocityChangeY < 0 or rune == 1:
            for value36 in value29:
                sprites.set_data_number(value36, "constructGravity", 0)
        else:
            for value37 in value29:
                sprites.change_data_number_by(value37, "constructGravity", 0.2)
        for value38 in value29:
            sprites.set_data_number(value38,
                "constructGravity",
                Math.constrain(sprites.read_data_number(value38, "constructGravity"), 0, 20))
        if rune == 0:
            finalY += sprites.read_data_number(value29[0], "constructGravity")
        loop = max(Math.floor(abs(finalX / 4)), Math.floor(abs(finalY / 4)))
        index2 = 0
        while index2 <= loop:
            if finalX >= 4:
                for value39 in value29:
                    value39.x += 4
                finalX += -4
            elif finalX <= -4:
                for value310 in value29:
                    value310.x += -4
                finalX += 4
            if finalY >= 4:
                for value311 in value29:
                    value311.y += 4
                finalY += -4
            elif finalY <= -4:
                for value312 in value29:
                    value312.y += -4
                finalY += 4
            index22 = 0
            while index22 <= len(value29):
                for value211 in value29:
                    value211.set_position(value29[0].x - sprites.read_data_number(value29[0], "offsetX") + sprites.read_data_number(value211, "offsetX"),
                        value29[0].y - sprites.read_data_number(value29[0], "offsetY") + sprites.read_data_number(value211, "offsetY"))
                value29.append(value29.shift())
                index22 += 1
            index2 += 1
        for value313 in value29:
            value313.x += finalX
            value313.y += finalY
        index23 = 0
        while index23 <= len(value29):
            for value212 in value29:
                value212.set_position(value29[0].x - sprites.read_data_number(value29[0], "offsetX") + sprites.read_data_number(value212, "offsetX"),
                    value29[0].y - sprites.read_data_number(value29[0], "offsetY") + sprites.read_data_number(value212, "offsetY"))
                if sprites.read_data_string(value212, "type") == "controller (occupied)":
                    mySprite.set_position(value212.x, value212.y - 1)
                    transformSprites.rotate_sprite(mySprite, transformSprites.get_rotation(value212))
            value29.append(value29.shift())
            index23 += 1
spriteutils.add_event_handler(spriteutils.UpdatePriorityModifier.BEFORE,
    spriteutils.UpdatePriority.CAMERA,
    on_add_handler_update_priority_modifier_before_camera)

def on_down_pressed():
    pass
controller.down.on_event(ControllerButtonEvent.PRESSED, on_down_pressed)

def overlapsWithArray(spriteWithArray: Sprite, otherSprite4: Sprite):
    for value30 in allConnections:
        if value30.index(spriteWithArray) != -1:
            for value213 in value30:
                if value213.overlaps_with(otherSprite4) and value30.index(otherSprite4) == -1:
                    return True
            return False
    if spriteWithArray.overlaps_with(otherSprite4):
        return True
    else:
        return False

def on_on_overlap4(sprite10, otherSprite5):
    sprites.change_data_number_by(otherSprite5, "health", -1)
    sprites.destroy(sprite10)
    scene.camera_shake(4, 500)
    if sprites.read_data_number(otherSprite5, "health") <= 0:
        sprites.destroy(otherSprite5)
        blockSettings.write_number("finalBossComplete", 1)
        game.show_long_text("You defeated the dragon! You travel back to your home and realize... something that happened while your cat was captured gave it time-travelling powers! So you and your cat can now travel between past and present. (Present time isn't available in this game though!)",
            DialogLayout.FULL)
        game.game_over(True)
sprites.on_overlap(SpriteKind.projectile, SpriteKind.boss, on_on_overlap4)

def on_overlap_tile5(sprite11, location7):
    if mySprite.tile_kind_at(TileDirection.CENTER, assets.tile("""
        myTile10
    """)) and rune == 0:
        mySprite.say_text("Press A to read", 50, False)
        if controller.A.is_pressed():
            if area == 0:
                if mySprite.tilemap_location().column == 11:
                    game.show_long_text("Press < and > to move.", DialogLayout.BOTTOM)
                elif mySprite.tilemap_location().column == 13:
                    game.show_long_text("Press ^ to jump.", DialogLayout.BOTTOM)
                elif mySprite.tilemap_location().column == 85:
                    game.show_long_text("HINT: Gain enough height to swipe at the dragon!",
                        DialogLayout.BOTTOM)
                else:
                    pass
            elif area == 1:
                if mySprite.tilemap_location().column == 2:
                    game.show_long_text("Press A to swing your sword. It will send out a wave, destroying enemies.",
                        DialogLayout.BOTTOM)
                elif mySprite.tilemap_location().column == 56:
                    game.show_long_text("Collecting big hearts sends you out of the portal and increases your max health.",
                        DialogLayout.BOTTOM)
                elif mySprite.tilemap_location().column == 36:
                    game.show_long_text("Small hearts that heal 1 heart each can appear upon defeating enemies.",
                        DialogLayout.BOTTOM)
                else:
                    pass
            elif area == 2:
                if mySprite.tilemap_location().column == 2:
                    game.show_long_text("Press ^ while you are in the air to pull out your glider.",
                        DialogLayout.BOTTOM)
                elif mySprite.tilemap_location().column == 14:
                    game.show_long_text("Gusts of air will make you pull out your glider and can help you gain altitude.",
                        DialogLayout.BOTTOM)
                elif mySprite.tilemap_location().column == 56:
                    game.show_long_text("Now fly left to the beginning of the stage!",
                        DialogLayout.BOTTOM)
                else:
                    pass
            elif area == 3:
                if mySprite.tilemap_location().column == 3:
                    game.show_long_text("Press \\/ twice to activate merge. Press A to grab something, arrows to move, and A again to let go. If the selected object overlaps with another object, it will attach to that object.",
                        DialogLayout.FULL)
                    game.show_long_text("Hold B and click < or > to rotate objects that are not connected to other objects (if an object is connected to another, its rotation can't be changed). You can also hold B and press A to detach the selected object from all overlaping objects.",
                        DialogLayout.FULL)
                elif mySprite.tilemap_location().column == 17:
                    game.show_long_text("Wheels are great for making cars and controllable contraptions.",
                        DialogLayout.BOTTOM)
                elif mySprite.tilemap_location().column == 21:
                    game.show_long_text("Attach a controller to a construct to make a construct work. Press A near the contoller to get in.",
                        DialogLayout.FULL)
                elif mySprite.tilemap_location().column == 10:
                    game.show_long_text("Platforms are a great central building point of vehicles.",
                        DialogLayout.BOTTOM)
                elif mySprite.tilemap_location().column == 43:
                    game.show_long_text("Fans are useful for vertical travel. Unlike wheels, you cannot control them during flight.",
                        DialogLayout.FULL)
                else:
                    pass
            elif area == 4:
                if mySprite.tilemap_location().column == 2:
                    game.show_long_text("Rockets can help you to fly super far!",
                        DialogLayout.BOTTOM)
                    game.show_long_text("HINT: Rotate the rocket to face the top-right so your construct can more easily reach the ledge. (remember to hold B and press A to detach, and hold B and use < or > to rotate).",
                        DialogLayout.FULL)
            elif area == 5:
                if mySprite.tilemap_location().column == 2:
                    game.show_long_text("Use your gravity-pull ability with B to float towards a nearby point! Then, press B to cancel.",
                        DialogLayout.FULL)
                elif mySprite.tilemap_location().column == 23:
                    game.show_long_text("Press ^ to jump and ^ again to glide our of a gravity point.",
                        DialogLayout.FULL)
                else:
                    pass
            else:
                pass
            
            def on_pause_until7():
                pass
            pause_until(on_pause_until7)
            
        if True:
            pass
scene.on_overlap_tile(SpriteKind.player,
    assets.tile("""
        myTile10
    """),
    on_overlap_tile5)

def on_on_created(sprite12):
    
    def on_background2():
        for index3 in range(5):
            if sprites.read_data_number(sprite12, "health") > 0:
                index3 = 0
                sprite12.vx = 0 - sprite12.vx
                for value31 in bossAnimation:
                    value31.flip_x()
                animation.run_image_animation(boss2, bossAnimation, 500, True)
                pause(4000)
    timer.background(on_background2)
    
    
    def on_background3():
        global projectile
        for index4 in range(5):
            if sprites.read_data_number(sprite12, "health") > 0:
                index4 = 0
                projectile = sprites.create_projectile_from_sprite(img("""
                        . . . . 2 2 . . . . 
                                            . . 2 2 2 2 2 2 . . 
                                            . 2 2 2 2 2 2 2 2 . 
                                            . 2 2 2 2 2 2 2 2 . 
                                            2 2 2 2 2 2 2 2 2 2 
                                            2 2 2 2 2 2 2 2 2 2 
                                            . 2 2 2 2 2 2 2 2 . 
                                            . 2 2 2 2 2 2 2 2 . 
                                            . . 2 2 2 2 2 2 . . 
                                            . . . . 2 2 . . . .
                    """),
                    sprite12,
                    Math.cos(spriteutils.angle_from(sprite12, mySprite)) * 25,
                    Math.sin(spriteutils.angle_from(sprite12, mySprite)) * 25)
                projectile.set_kind(SpriteKind.enemy)
                projectile.set_flag(SpriteFlag.AUTO_DESTROY, False)
                projectile.set_flag(SpriteFlag.DESTROY_ON_WALL, True)
                projectile.lifespan = 2000
                pause(1000)
    timer.background(on_background3)
    
sprites.on_created(SpriteKind.boss, on_on_created)

def on_on_overlap5(sprite13, otherSprite6):
    global heartSprite
    sprites.destroy(sprite13)
    if Math.percent_chance(25):
        heartSprite = sprites.create(img("""
                . 2 . 2 . 
                            2 2 2 2 2 
                            2 2 2 2 2 
                            . 2 2 2 . 
                            . . 2 . .
            """),
            SpriteKind.food)
        heartSprite.set_position(otherSprite6.x, otherSprite6.y)
        heartSprite.ay = 500
    sprites.destroy(otherSprite6)
sprites.on_overlap(SpriteKind.projectile, SpriteKind.enemy, on_on_overlap5)

def on_overlap_tile6(sprite14, location8):
    if rune == 0:
        mySprite.say_text("Press A to heal", 50, False)
        if controller.A.is_pressed():
            info.set_life(blockSettings.read_number("maxHealth"))
scene.on_overlap_tile(SpriteKind.player,
    assets.tile("""
        myTile23
    """),
    on_overlap_tile6)

particle: Sprite = None
heartSprite: Sprite = None
boss2: Sprite = None
bossAnimation: List[Image] = []
loop = 0
velocityChangeY = 0
velocityChangeX = 0
finalY = 0
finalX = 0
projectile: Sprite = None
list2: List[number] = []
prevPos: tiles.Location = None
area = 0
posY = 0
posX = 0
selectedBlock: tiles.Location = None
branches: List[List[Sprite]] = []
cursor: Sprite = None
connect = False
holdingState = 0
partOfObject = False
object3: Sprite = None
mounted = False
dinosaur: Sprite = None
gliding = 0
inAir = 0
rune = 0
allConnections: List[List[Sprite]] = []
tileImg: Image = None
animationPullOutGlider: List[Image] = []
animationJumping: List[Image] = []
direction = 0
mySprite: Sprite = None
if not (blockSettings.exists("maxHealth")):
    game.show_long_text("You wake up one day, only to find that your cat is gone and the world has been littered with mysterious portals and technology. The sun is brighter and dinosaurs now roam the area. Your ancient house (no one knows when it was built) looks new again.",
        DialogLayout.FULL)
    game.show_long_text("The dissappearence of the cat and the changes to the area must have a connection, you think to yourself. You decide to explore and find evidence about where your cat went.",
        DialogLayout.FULL)
    blockSettings.write_number("maxHealth", 3)
    blockSettings.write_number("finalBossComplete", 0)
    blockSettings.write_number_array("areasCleared", [])
info.set_life(blockSettings.read_number("maxHealth"))
stats.turn_stats(True)
scene.set_background_color(9)
scene.set_background_image(img("""
    ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
        ................................................................................................................................................................
"""))
mySprite = sprites.create(img("""
        . . . 5 5 5 5 5 5 . . . 
            . . 5 4 4 4 4 5 . . . . 
            . . . 4 4 4 f . . . . . 
            . . . 4 4 4 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 4 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . . f f f . . . . .
    """),
    SpriteKind.player)
mySprite.z = 1
scene.camera_follow_sprite(mySprite)
direction = 0
animationWalking = [img("""
        . . . 5 5 5 5 5 5 . . . 
            . . 5 4 4 4 4 5 . . . . 
            . . . 4 4 4 f . . . . . 
            . . . 4 4 4 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 4 7 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . 6 8 8 . . . . . . 
            . . . 6 8 8 . . . . . . 
            . . . e f f f . . . . .
    """),
    img("""
        . . . . . . . . . . . . 
            . . . 5 5 5 5 5 5 . . . 
            . . 5 4 4 4 4 5 . . . . 
            . . . 4 4 4 f . . . . . 
            . . . 4 4 4 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 6 7 . . . . . . 
            . . . . 4 7 . . . . . . 
            . . . 6 8 8 8 . . . . . 
            . . 6 6 6 8 8 8 . . . . 
            . . e e . . 8 f f . . . 
            . . . e e . f f . . . .
    """),
    img("""
        . . . 5 5 5 5 5 5 . . . 
            . . 5 4 4 4 4 5 . . . . 
            . . . 4 4 4 f . . . . . 
            . . . 4 4 4 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 4 7 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . 6 8 8 . . . . . . 
            . . . 6 8 8 . . . . . . 
            . . . e f f f . . . . .
    """),
    img("""
        . . . 5 5 5 5 5 5 . . . 
            . . 5 4 4 4 4 5 . . . . 
            . . . 4 4 4 f . . . . . 
            . . . 4 4 4 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 4 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . . f f f . . . . .
    """),
    img("""
        . . . 5 5 5 5 5 5 . . . 
            . . 5 4 4 4 4 5 . . . . 
            . . . 4 4 4 f . . . . . 
            . . . 4 4 4 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 7 4 . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . 8 8 6 . . . . . . 
            . . . 8 8 6 . . . . . . 
            . . . f f f e . . . . .
    """),
    img("""
        . . . . . . . . . . . . 
            . . . 5 5 5 5 5 5 . . . 
            . . 5 4 4 4 4 5 . . . . 
            . . . 4 4 4 f . . . . . 
            . . . 4 4 4 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 7 6 . . . . . 
            . . . . 7 7 4 . . . . . 
            . . . 8 8 8 6 . . . . . 
            . . 8 8 8 6 6 6 . . . . 
            . . f f . . 6 e e . . . 
            . . . f f . e e . . . .
    """),
    img("""
        . . . 5 5 5 5 5 5 . . . 
            . . 5 4 4 4 4 5 . . . . 
            . . . 4 4 4 f . . . . . 
            . . . 4 4 4 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 7 4 . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . 8 8 6 . . . . . . 
            . . . 8 8 6 . . . . . . 
            . . . f f f e . . . . .
    """),
    img("""
        . . . 5 5 5 5 5 5 . . . 
            . . 5 4 4 4 4 5 . . . . 
            . . . 4 4 4 f . . . . . 
            . . . 4 4 4 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 4 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . . f f f . . . . .
    """)]
animationJumping = [img("""
        . . . . . . . . . . . . 
            . . . 5 5 5 5 5 5 . . . 
            . . 5 4 4 4 4 5 . . . . 
            . . . 4 4 4 f . . . . . 
            . . . 4 4 4 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 4 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . . . 8 8 . . . . . 
            . . . . 8 8 . . . . . . 
            . . . . f f f . . . . .
    """),
    img("""
        . . . 5 5 5 5 5 5 . . . 
            . . 5 4 4 4 4 5 . . . . 
            . . . 4 4 4 f . . . . . 
            . . . 4 4 4 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 4 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . . . 8 8 . . . . . 
            . . . . . 8 8 . . . . . 
            . . . . 8 8 . . . . . . 
            . . . . f f f . . . . .
    """),
    img("""
        . . . . 5 5 5 5 5 . . . 
            . . . 5 4 4 4 4 5 . . . 
            . . . . 4 4 4 f . . . . 
            . . . . 4 4 4 4 . . . . 
            . . . . . 7 6 . . . . . 
            . . . . . 6 7 . . . . . 
            . . . . . 4 7 . . . . . 
            . . . . . 8 8 . . . . . 
            . . . . . 8 8 . . . . . 
            . . . . 6 8 8 . . . . . 
            . . . . 6 8 8 . . . . . 
            . . . . e f f f . . . .
    """),
    img("""
        . . . . 5 5 5 5 5 . . . 
            . . . 5 4 4 4 4 5 . . . 
            . . . . 4 4 4 f . . . . 
            . . . . 4 4 4 4 . . . . 
            . . . . . 7 6 . . . . . 
            . . . . . 6 7 . . . . . 
            . . . . 4 7 7 . . . . . 
            . . . . . 8 8 . . . . . 
            . . . . 6 8 8 8 . . . . 
            . . . 6 6 6 8 8 8 . . . 
            . . . e e . . 8 f f . . 
            . . . . e e . f f . . .
    """)]
animationPullOutGlider = [img("""
        . . . 5 5 5 5 5 5 . . . 
            . . 5 4 4 4 4 5 . . . . 
            . . . 4 4 4 f . . . . . 
            . . . 4 4 4 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 4 . . . . . . 
            . . . . 7 e . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . 6 8 8 8 . . . . . 
            . . 6 6 6 8 8 8 . . . . 
            . . e e . . 8 f f . . . 
            . . . e e . f f . . . . 
            . . . . . . . . . . . . 
            . . . . . . . . . . . . 
            . . . . . . . . . . . . 
            . . . . . . . . . . . .
    """),
    img("""
        . . . 5 5 5 5 5 5 . . . 
            . . 5 4 4 4 4 5 . . . . 
            . . . 4 4 4 f . . . . . 
            . . . 4 4 4 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 4 . . . . . . 
            . . . . 8 e . . . . . . 
            . . . 6 8 8 8 . . . . . 
            . . 6 6 6 8 8 8 . . . . 
            . . e e . . 8 f f . . . 
            . . . e e . f f . . . . 
            . . . . . . . . . . . . 
            . . . . . . . . . . . . 
            . . . . . . . . . . . . 
            . . . . . . . . . . . .
    """),
    img("""
        . . . . . . . . . . . . 
            . . . 5 5 5 5 5 5 . . . 
            . . 5 4 4 4 4 5 . . . . 
            . . . 4 4 4 f . . . . . 
            . . . 4 4 4 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 6 7 . . . . . . 
            . . . 6 7 7 . . . . . . 
            . e 4 . 8 8 . . . . . . 
            . . e 6 8 8 8 . . . . . 
            . . 6 6 6 8 8 8 . . . . 
            . . e e . . 8 f f . . . 
            . . . e e . f f . . . . 
            . . . . . . . . . . . . 
            . . . . . . . . . . . . 
            . . . . . . . . . . . .
    """),
    img("""
        . . . . . . . . . . . . 
            . . . 5 5 5 5 5 5 . . . 
            . . 5 4 4 4 4 5 . . . . 
            . . . 4 4 4 f . . . . . 
            . . . 4 4 4 4 . . . . . 
            e 4 6 6 6 6 . . . . . . 
            e e . . 7 7 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . 6 8 8 8 . . . . . 
            . . 6 6 6 8 8 8 . . . . 
            . . e e . . 8 f f . . . 
            . . . e e . f f . . . . 
            . . . . . . . . . . . . 
            . . . . . . . . . . . .
    """),
    img("""
        . . . . . . . . . . . . 
            e e . . . . . . . . . . 
            e e . . . . . . . . . . 
            e 4 . 5 5 5 5 5 5 . . . 
            . . 6 4 4 4 4 5 . . . . 
            . . . 6 4 4 f . . . . . 
            . . . 4 6 4 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . 6 8 8 8 . . . . . 
            . . 6 6 6 8 8 8 . . . . 
            . . e e . . 8 f f . . . 
            . . . e e . f f . . . . 
            . . . . . . . . . . . .
    """),
    img("""
        . . . . d d d d d . . . 
            f . . e e e e e e d d d 
            . f f . . e . . . e e e 
            f . . . . 4 . . . . . . 
            . . . 5 5 6 5 5 5 . . . 
            . . 5 4 4 6 4 5 . . . . 
            . . . 4 4 6 f . . . . . 
            . . . 4 4 6 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . 6 8 8 8 . . . . . 
            . . 6 6 6 8 8 8 . . . . 
            . . e e . . 8 f f . . . 
            . . . e e . f f . . . .
    """)]
animationGliding = [img("""
        . . . . d d d d d . . . 
            f . . e e e e e e d d d 
            . f f . . e . . . e e e 
            f . . . . 4 . . . . . . 
            . . . 5 5 6 5 5 5 . . . 
            . . 5 4 4 6 4 5 . . . . 
            . . . 4 4 6 f . . . . . 
            . . . 4 4 6 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . 6 8 8 8 . . . . . 
            . . 6 6 6 8 8 8 . . . . 
            . . e e . . 8 f f . . . 
            . . . e e . f f . . . .
    """),
    img("""
        . . . . d d d d d . . . 
            . . . e e e e e e d d d 
            f f f . . e . . . e e e 
            . . . . . 4 . . . . . . 
            . . . 5 5 6 5 5 5 . . . 
            . . 5 4 4 6 4 5 . . . . 
            . . . 4 4 6 f . . . . . 
            . . . 4 4 6 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . 6 8 8 8 . . . . . 
            . . 6 6 6 8 8 8 . . . . 
            . . e e . . 8 f f . . . 
            . . . e e . f f . . . .
    """),
    img("""
        . . . . d d d d d . . . 
            f . . e e e e e e d d d 
            f f f . . e . . . e e e 
            . . . . . 4 . . . . . . 
            . . . 5 5 6 5 5 5 . . . 
            . . 5 4 4 6 4 5 . . . . 
            . . . 4 4 6 f . . . . . 
            . . . 4 4 6 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . 6 8 8 8 . . . . . 
            . . 6 6 6 8 8 8 . . . . 
            . . e e . . 8 f f . . . 
            . . . e e . f f . . . .
    """),
    img("""
        f . . . d d d d d . . . 
            f f . e e e e e e d d d 
            . . f . . e . . . e e e 
            . . . . . 4 . . . . . . 
            . . . 5 5 6 5 5 5 . . . 
            . . 5 4 4 6 4 5 . . . . 
            . . . 4 4 6 f . . . . . 
            . . . 4 4 6 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . 6 8 8 8 . . . . . 
            . . 6 6 6 8 8 8 . . . . 
            . . e e . . 8 f f . . . 
            . . . e e . f f . . . .
    """),
    img("""
        . . . . d d d d d . . . 
            . . . e e e e e e d d d 
            f f f . . e . . . e e e 
            f . . . . 4 . . . . . . 
            . . . 5 5 6 5 5 5 . . . 
            . . 5 4 4 6 4 5 . . . . 
            . . . 4 4 6 f . . . . . 
            . . . 4 4 6 4 . . . . . 
            . . . . 7 6 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 7 7 . . . . . . 
            . . . . 8 8 . . . . . . 
            . . . 6 8 8 8 . . . . . 
            . . 6 6 6 8 8 8 . . . . 
            . . e e . . 8 f f . . . 
            . . . e e . f f . . . .
    """)]
animations = [animationWalking,
    animationJumping,
    animationPullOutGlider,
    animationGliding]
tiles.set_current_tilemap(tileUtil.create_small_map(tilemap("""
    level1
""")))
tiles.place_on_tile(mySprite, tiles.get_tile_location(11, 151))
mySprite.ay = 500
for value40 in tiles.get_tiles_by_type(assets.tile("""
    myTile9
""")):
    tileImg = img("""
        . 7 7 7 7 7 7 . 
                7 7 7 7 7 7 7 7 
                7 7 7 7 7 7 7 7 
                7 7 7 7 7 7 7 7 
                7 7 7 7 7 7 7 7 
                7 7 7 7 7 7 7 7 
                7 7 7 7 7 7 7 7 
                . 7 7 7 7 7 7 .
    """)
    tiles.set_tile_at(tiles.get_tile_location(value40.column, value40.row),
        tileImg)
allConnections = []
loadMap()

def on_on_update():
    global direction, gliding, inAir, holdingState, velocityChangeX, velocityChangeY, particle, mounted, boss2, bossAnimation
    for value41 in sprites.all_of_kind(SpriteKind.enemy):
        if value41.is_hitting_tile(CollisionDirection.LEFT):
            animation.run_image_animation(value41,
                [img("""
                        . . . . . . . . . . . 7 7 7 7 . 
                                        . . . . . . . . . . 7 7 7 7 7 7 
                                        . . . . . . . . . . 7 7 7 7 f 7 
                                        . . . . . . . . . . 7 7 7 7 7 7 
                                        . . . . . . . . . . 7 7 7 7 1 1 
                                        . . . . . . . . . . . 7 7 7 7 . 
                                        . 6 . . . . . . . . . . 7 7 . . 
                                        . 7 . . . . . . . . . . 7 7 . . 
                                        . 7 . . . . . . . 6 . 7 7 7 . . 
                                        . 7 7 . 6 . . 6 . 7 7 7 7 7 . 7 
                                        . . 7 7 7 . . 7 7 7 7 7 7 . 7 . 
                                        . . . 7 7 7 7 7 7 7 7 7 7 . . 7 
                                        . . . . 7 7 7 7 7 7 7 7 . . . . 
                                        . . . . . . . 7 7 . . . . . . . 
                                        . . . . . . . 7 7 . . . . . . . 
                                        . . . . . . . 7 7 7 . . . . . .
                    """),
                    img("""
                        . . . . . . . . . . . 7 7 7 7 . 
                                        . . . . . . . . . . 7 7 7 7 7 7 
                                        . . . . . . . . . . 7 7 7 7 f 7 
                                        . . . . . . . . . . 7 7 7 7 7 7 
                                        . . . . . . . . . . 7 7 7 7 1 1 
                                        . . . . . . . . . . . 7 7 7 7 . 
                                        . 6 . . . . . . . . . . 7 7 . . 
                                        . 7 . . . . . . . . . . 7 7 . . 
                                        . 7 . . . . . . . 6 . 7 7 7 . . 
                                        . 7 7 . 6 . . 6 . 7 7 7 7 7 . 7 
                                        . . 7 7 7 . . 7 7 7 7 7 7 . 7 . 
                                        . . . 7 7 7 7 7 7 7 7 7 7 . . 7 
                                        . . . . 7 7 7 7 7 7 7 7 . . . . 
                                        . . . . . . 6 6 7 7 . . . . . . 
                                        . . . . . 6 6 . 7 7 . 7 . . . . 
                                        . . . . . 6 6 6 . 7 7 . . . . .
                    """),
                    img("""
                        . . . . . . . . . . . 7 7 7 7 . 
                                        . . . . . . . . . . 7 7 7 7 7 7 
                                        . . . . . . . . . . 7 7 7 7 f 7 
                                        . . . . . . . . . . 7 7 7 7 7 7 
                                        . . . . . . . . . . 7 7 7 7 1 1 
                                        . . . . . . . . . . . 7 7 7 7 . 
                                        . 6 . . . . . . . . . . 7 7 . . 
                                        . 7 . . . . . . . . . . 7 7 . . 
                                        . 7 . . . . . . . 6 . 7 7 7 . . 
                                        . 7 7 . 6 . . 6 . 7 7 7 7 7 . 7 
                                        . . 7 7 7 . . 7 7 7 7 7 7 . 7 . 
                                        . . . 7 7 7 7 7 7 7 7 7 7 . . 7 
                                        . . . . 7 7 7 7 7 7 7 7 . . . . 
                                        . . . . . . . 7 7 . . . . . . . 
                                        . . . . . . . 7 7 . . . . . . . 
                                        . . . . . . . 7 7 7 . . . . . .
                    """),
                    img("""
                        . . . . . . . . . . . 7 7 7 7 . 
                                        . . . . . . . . . . 7 7 7 7 7 7 
                                        . . . . . . . . . . 7 7 7 7 f 7 
                                        . . . . . . . . . . 7 7 7 7 7 7 
                                        . . . . . . . . . . 7 7 7 7 1 1 
                                        . . . . . . . . . . . 7 7 7 7 . 
                                        . 6 . . . . . . . . . . 7 7 . . 
                                        . 7 . . . . . . . . . . 7 7 . . 
                                        . 7 . . . . . . . 6 . 7 7 7 . . 
                                        . 7 7 . 6 . . 6 . 7 7 7 7 7 . 7 
                                        . . 7 7 7 . . 7 7 7 7 7 7 . 7 . 
                                        . . . 7 7 7 7 7 7 7 7 7 7 . . 7 
                                        . . . . 7 7 7 7 7 7 7 7 . . . . 
                                        . . . . . . 7 7 6 6 . . . . . . 
                                        . . . . . 7 7 . 6 6 . 6 . . . . 
                                        . . . . . 7 7 7 . 6 6 . . . . .
                    """)],
                500,
                True)
            value41.vx = 10
        elif value41.is_hitting_tile(CollisionDirection.RIGHT):
            animation.run_image_animation(value41,
                [img("""
                        . 7 7 7 7 . . . . . . . . . . . 
                                        7 7 7 7 7 7 . . . . . . . . . . 
                                        7 f 7 7 7 7 . . . . . . . . . . 
                                        7 7 7 7 7 7 . . . . . . . . . . 
                                        1 1 7 7 7 7 . . . . . . . . . . 
                                        . 7 7 7 7 . . . . . . . . . . . 
                                        . . 7 7 . . . . . . . . . . 6 . 
                                        . . 7 7 . . . . . . . . . . 7 . 
                                        . . 7 7 7 . 6 . . . . . . . 7 . 
                                        7 . 7 7 7 7 7 . 6 . . 6 . 7 7 . 
                                        . 7 . 7 7 7 7 7 7 . . 7 7 7 . . 
                                        7 . . 7 7 7 7 7 7 7 7 7 7 . . . 
                                        . . . . 7 7 7 7 7 7 7 7 . . . . 
                                        . . . . . . . 7 7 . . . . . . . 
                                        . . . . . . . 7 7 . . . . . . . 
                                        . . . . . . 7 7 7 . . . . . . .
                    """),
                    img("""
                        . 7 7 7 7 . . . . . . . . . . . 
                                        7 7 7 7 7 7 . . . . . . . . . . 
                                        7 f 7 7 7 7 . . . . . . . . . . 
                                        7 7 7 7 7 7 . . . . . . . . . . 
                                        1 1 7 7 7 7 . . . . . . . . . . 
                                        . 7 7 7 7 . . . . . . . . . . . 
                                        . . 7 7 . . . . . . . . . . 6 . 
                                        . . 7 7 . . . . . . . . . . 7 . 
                                        . . 7 7 7 . 6 . . . . . . . 7 . 
                                        7 . 7 7 7 7 7 . 6 . . 6 . 7 7 . 
                                        . 7 . 7 7 7 7 7 7 . . 7 7 7 . . 
                                        7 . . 7 7 7 7 7 7 7 7 7 7 . . . 
                                        . . . . 7 7 7 7 7 7 7 7 . . . . 
                                        . . . . . . 7 7 6 6 . . . . . . 
                                        . . . . 7 . 7 7 . 6 6 . . . . . 
                                        . . . . . 7 7 . 6 6 6 . . . . .
                    """),
                    img("""
                        . 7 7 7 7 . . . . . . . . . . . 
                                        7 7 7 7 7 7 . . . . . . . . . . 
                                        7 f 7 7 7 7 . . . . . . . . . . 
                                        7 7 7 7 7 7 . . . . . . . . . . 
                                        1 1 7 7 7 7 . . . . . . . . . . 
                                        . 7 7 7 7 . . . . . . . . . . . 
                                        . . 7 7 . . . . . . . . . . 6 . 
                                        . . 7 7 . . . . . . . . . . 7 . 
                                        . . 7 7 7 . 6 . . . . . . . 7 . 
                                        7 . 7 7 7 7 7 . 6 . . 6 . 7 7 . 
                                        . 7 . 7 7 7 7 7 7 . . 7 7 7 . . 
                                        7 . . 7 7 7 7 7 7 7 7 7 7 . . . 
                                        . . . . 7 7 7 7 7 7 7 7 . . . . 
                                        . . . . . . . 7 7 . . . . . . . 
                                        . . . . . . . 7 7 . . . . . . . 
                                        . . . . . . 7 7 7 . . . . . . .
                    """),
                    img("""
                        . 7 7 7 7 . . . . . . . . . . . 
                                        7 7 7 7 7 7 . . . . . . . . . . 
                                        7 f 7 7 7 7 . . . . . . . . . . 
                                        7 7 7 7 7 7 . . . . . . . . . . 
                                        1 1 7 7 7 7 . . . . . . . . . . 
                                        . 7 7 7 7 . . . . . . . . . . . 
                                        . . 7 7 . . . . . . . . . . 6 . 
                                        . . 7 7 . . . . . . . . . . 7 . 
                                        . . 7 7 7 . 6 . . . . . . . 7 . 
                                        7 . 7 7 7 7 7 . 6 . . 6 . 7 7 . 
                                        . 7 . 7 7 7 7 7 7 . . 7 7 7 . . 
                                        7 . . 7 7 7 7 7 7 7 7 7 7 . . . 
                                        . . . . 7 7 7 7 7 7 7 7 . . . . 
                                        . . . . . . 6 6 7 7 . . . . . . 
                                        . . . . 6 . 6 6 . 7 7 . . . . . 
                                        . . . . . 6 6 . 7 7 7 . . . . .
                    """)],
                500,
                True)
            value41.vx = -10
    if rune == 0:
        controller.move_sprite(mySprite, 100, 0)
        if controller.right.is_pressed() and direction == 1 or controller.left.is_pressed() and direction == 0:
            index5 = 0
            while index5 <= len(animations) - 1:
                for value44 in animations[index5]:
                    value44.flip_x()
                index5 += 1
            direction = (direction + 1) % 2
        if (controller.left.is_pressed() or controller.right.is_pressed()) and mySprite.is_hitting_tile(CollisionDirection.BOTTOM):
            
            def on_throttle3():
                animation.run_image_animation(mySprite, animationWalking, 50, False)
            timer.throttle("a1", 50 * len(animationWalking), on_throttle3)
            
        if mySprite.is_hitting_tile(CollisionDirection.BOTTOM):
            if inAir == 1:
                mySprite.set_image(img("""
                    . . . 5 5 5 5 5 5 . . . 
                                        . . 5 4 4 4 4 5 . . . . 
                                        . . . 4 4 4 f . . . . . 
                                        . . . 4 4 4 4 . . . . . 
                                        . . . . 7 6 . . . . . . 
                                        . . . . 7 6 . . . . . . 
                                        . . . . 7 4 . . . . . . 
                                        . . . . 7 7 . . . . . . 
                                        . . . . 8 8 . . . . . . 
                                        . . . . 8 8 . . . . . . 
                                        . . . . 8 8 . . . . . . 
                                        . . . . f f f . . . . .
                """))
                if direction == 1:
                    mySprite.image.flip_x()
            if gliding == 1:
                mySprite.y += 4
                animation.stop_animation(animation.AnimationTypes.ALL, mySprite)
            gliding = 0
            inAir = 0
        else:
            inAir = 1
        if gliding == 1:
            
            def on_throttle4():
                animation.run_image_animation(mySprite, animationGliding, 100, False)
            timer.throttle("a2", 100 * len(animationGliding), on_throttle4)
            
            if mySprite.vy > 15:
                mySprite.vy = 15
            controller.move_sprite(mySprite, 125, 0)
    elif rune == 1:
        controller.move_sprite(mySprite, 0, 0)
        if holdingState == 0:
            if controller.A.is_pressed():
                for value45 in sprites.all_of_kind(SpriteKind.physicsObject):
                    if cursor.overlaps_with(value45):
                        
                        def on_pause_until8():
                            pass
                        pause_until(on_pause_until8)
                        
                        holdingState = 1
                        value45.set_flag(SpriteFlag.STAY_IN_SCREEN, True)
                        holdObject(value45)
                        break
    else:
        pass
    velocityChangeX = 0
    velocityChangeY = 0
    for value46 in allConnections:
        for value214 in value46:
            if sprites.read_data_string(value214, "type") == "controller (occupied)":
                for value314 in value46:
                    if sprites.read_data_string(value314, "type") == "fan":
                        velocityChangeX += Math.cos(spriteutils.degrees_to_radians(transformSprites.get_rotation(value314) - 90)) * 0.5
                        velocityChangeY += Math.sin(spriteutils.degrees_to_radians(transformSprites.get_rotation(value314) - 90)) * 0.5
                        if Math.percent_chance((abs(velocityChangeX) + abs(velocityChangeY)) * 3):
                            particle = sprites.create_projectile_from_sprite(img("""
                                    . . . . 1 . . . . 
                                                                    . . . . 1 . . . . 
                                                                    . . . . 1 . . . . 
                                                                    . . . . 1 . . . . 
                                                                    . . . . 1 . . . . 
                                                                    . . . . 1 . . . . 
                                                                    . . . . 1 . . . . 
                                                                    . . . . 1 . . . . 
                                                                    . . . . 1 . . . .
                                """),
                                value314,
                                0 - velocityChangeX,
                                0 - velocityChangeY)
                            particle.set_kind(SpriteKind.FanGust)
                            transformSprites.rotate_sprite(particle, transformSprites.get_rotation(value314))
                            particle.x += (0 - velocityChangeX) * 4 + randint(-5, 5)
                            particle.y += (0 - velocityChangeY) * 4 + randint(-5, 5)
                            particle.lifespan = 500
                            particle.set_flag(SpriteFlag.AUTO_DESTROY, True)
                    if sprites.read_data_string(value314, "type") == "rocket":
                        velocityChangeX += Math.cos(spriteutils.degrees_to_radians(transformSprites.get_rotation(value314) - 90)) * 4
                        velocityChangeY += Math.sin(spriteutils.degrees_to_radians(transformSprites.get_rotation(value314) - 90)) * 4
                        if Math.percent_chance((abs(velocityChangeX) + abs(velocityChangeY)) * 8):
                            particle = sprites.create_projectile_from_sprite(img("""
                                    f
                                """),
                                value314,
                                0 - velocityChangeX,
                                0 - velocityChangeY)
                            transformSprites.rotate_sprite(particle, transformSprites.get_rotation(value314))
                            particle.x += (0 - velocityChangeX) * 4 + randint(-2, 2)
                            particle.y += (0 - velocityChangeY) * 4 + randint(-2, 2)
                            particle.lifespan = 500
                    if sprites.read_data_string(value314, "type") == "wheel":
                        if tiles.tile_at_location_is_wall(tiles.get_tile_location(value314.tilemap_location().column + Math.constrain(Math.cos(spriteutils.degrees_to_radians(transformSprites.get_rotation(value314) + 70)) * 9,
                                    -1.5,
                                    1.5),
                                value314.tilemap_location().row + Math.constrain(Math.sin(spriteutils.degrees_to_radians(transformSprites.get_rotation(value314) + 70)) * 9,
                                    -1.5,
                                    1.5))) or tiles.tile_at_location_is_wall(tiles.get_tile_location(value314.tilemap_location().column + Math.constrain(Math.cos(spriteutils.degrees_to_radians(transformSprites.get_rotation(value314) + 110)) * 9,
                                    -1.5,
                                    1.5),
                                value314.tilemap_location().row + Math.constrain(Math.sin(spriteutils.degrees_to_radians(transformSprites.get_rotation(value314) + 110)) * 9,
                                    -1.5,
                                    1.5))):
                            print(Math.cos(spriteutils.degrees_to_radians(transformSprites.get_rotation(value314) + 70)))
                            if transformSprites.get_rotation(value314) < 0:
                                index6 = 0
                                while index6 <= Math.ceil((0 - transformSprites.get_rotation(value314)) / 360):
                                    transformSprites.change_rotation(value314, 360)
                                    index6 += 1
                            transformSprites.rotate_sprite(value314, transformSprites.get_rotation(value314) % 360)
                            if (transformSprites.get_rotation(value314) < 90 or transformSprites.get_rotation(value314) > 270) and (tiles.tile_at_location_is_wall(tiles.get_tile_location(value314.x / 8, (value314.bottom + 1) / 8)) or (tiles.tile_at_location_is_wall(tiles.get_tile_location((value314.left - 1) / 8, (value314.bottom + 1) / 8)) or tiles.tile_at_location_is_wall(tiles.get_tile_location((value314.right + 1) / 8, (value314.bottom + 1) / 8)))):
                                if controller.left.is_pressed():
                                    velocityChangeX += Math.cos(spriteutils.degrees_to_radians(transformSprites.get_rotation(value314) - 180)) * 2
                                elif controller.right.is_pressed():
                                    velocityChangeX += Math.cos(spriteutils.degrees_to_radians(transformSprites.get_rotation(value314))) * 2
                            elif transformSprites.get_rotation(value314) > 90 and transformSprites.get_rotation(value314) < 270 and (tiles.tile_at_location_is_wall(tiles.get_tile_location(value314.x / 8, (value314.top - 1) / 8)) or (tiles.tile_at_location_is_wall(tiles.get_tile_location((value314.left - 1) / 8, (value314.top - 1) / 8)) or tiles.tile_at_location_is_wall(tiles.get_tile_location((value314.right + 1) / 8, (value314.top - 1) / 8)))):
                                if controller.left.is_pressed():
                                    velocityChangeX += Math.cos(spriteutils.degrees_to_radians(transformSprites.get_rotation(value314))) * 2
                                elif controller.right.is_pressed():
                                    velocityChangeX += Math.cos(spriteutils.degrees_to_radians(transformSprites.get_rotation(value314) - 180)) * 2
                            if transformSprites.get_rotation(value314) > 0 and transformSprites.get_rotation(value314) < 180 and (tiles.tile_at_location_is_wall(tiles.get_tile_location((value314.left - 1) / 8, value314.y / 8)) or (tiles.tile_at_location_is_wall(tiles.get_tile_location((value314.left - 1) / 8, (value314.top - 1) / 8)) or tiles.tile_at_location_is_wall(tiles.get_tile_location((value314.left - 1) / 8, (value314.bottom + 1) / 8)))):
                                if controller.up.is_pressed():
                                    velocityChangeY += Math.sin(spriteutils.degrees_to_radians(transformSprites.get_rotation(value314) - 180)) * 2
                                elif controller.down.is_pressed():
                                    velocityChangeY += Math.sin(spriteutils.degrees_to_radians(transformSprites.get_rotation(value314))) * 2
                            elif transformSprites.get_rotation(value314) > 180 and transformSprites.get_rotation(value314) < 360 and (tiles.tile_at_location_is_wall(tiles.get_tile_location((value314.right + 1) / 8, value314.y / 8)) or (tiles.tile_at_location_is_wall(tiles.get_tile_location((value314.right + 1) / 8, (value314.top - 1) / 8)) or tiles.tile_at_location_is_wall(tiles.get_tile_location((value314.right + 1) / 8, (value314.bottom + 1) / 8)))):
                                if controller.up.is_pressed():
                                    velocityChangeY += Math.sin(spriteutils.degrees_to_radians(transformSprites.get_rotation(value314))) * 2
                                elif controller.down.is_pressed():
                                    velocityChangeY += Math.sin(spriteutils.degrees_to_radians(transformSprites.get_rotation(value314) - 180)) * 2
                velocityChangeX = velocityChangeX / (len(value46) / 5)
                velocityChangeY = velocityChangeY / (len(value46) / 5)
    if rune == 0:
        for value47 in allConnections:
            for value215 in value47:
                if controller.A.is_pressed() and (sprites.read_data_string(value215, "type") == "controller (empty)" and spriteutils.distance_between(mySprite, value215) < 25):
                    
                    def on_pause_until9():
                        pass
                    pause_until(on_pause_until9)
                    
                    mounted = True
                    sprites.set_data_string(value215, "type", "controller (occupied)")
                    sprites.destroy_all_sprites_of_kind(SpriteKind.projectile)
                if sprites.read_data_string(value215, "type") == "controller (occupied)":
                    if controller.A.is_pressed():
                        
                        def on_pause_until10():
                            pass
                        pause_until(on_pause_until10)
                        
                        mounted = False
                        sprites.set_data_string(value215, "type", "controller (empty)")
                        transformSprites.rotate_sprite(mySprite, 0)
                    else:
                        gliding = 0
                        mySprite.vy = 0
                        animation.stop_animation(animation.AnimationTypes.ALL, mySprite)
                        mySprite.set_image(img("""
                            . . . 5 5 5 5 5 5 . . . 
                                                        . . 5 4 4 4 4 5 . . . . 
                                                        . . . 4 4 4 f . . . . . 
                                                        . . . 4 4 4 4 . . . . . 
                                                        . . . . 7 6 . . . . . . 
                                                        . . . . 7 6 . . . . . . 
                                                        . . . . 7 4 . . . . . . 
                                                        . . . . 7 7 . . . . . . 
                                                        . . . . 8 8 . . . . . . 
                                                        . . . . 8 8 . . . . . . 
                                                        . . . . 8 8 . . . . . . 
                                                        . . . . f f f . . . . .
                        """))
                        if direction == 1:
                            mySprite.image.flip_x()
        if mySprite.tile_kind_at(TileDirection.RIGHT, assets.tile("""
            myTile39
        """)) and blockSettings.read_number("finalBossComplete") == 0:
            for value48 in tiles.get_tiles_by_type(assets.tile("""
                myTile39
            """)):
                tiles.set_tile_at(value48, assets.tile("""
                    myTile40
                """))
                tiles.set_wall_at(value48, True)
                for value49 in tiles.get_tiles_by_type(assets.tile("""
                    myTile47
                """)):
                    boss2 = sprites.create(img("""
                            .............f4.............
                                                    ............f44.............
                                                    .22222......f44.........22..
                                                    2222222.....f44........2222.
                                                    2112222..f.f444......f.2222.
                                                    2f122222f22f444.......f2222.
                                                    2222222222f4444..f..f222222.
                                                    2222222222f44442f2.2f22222..
                                                    .ff2222222f44422222222222...
                                                    ....222222f4442222222222....
                                                    ....2222222222222222222.....
                                                    .....222222222222222........
                                                    ......22222222222...........
                                                    .......2.....2..............
                                                    ......22....22..............
                                                    ......2.....2...............
                                                    .....2.2...2.2..............
                                                    ............................
                        """),
                        SpriteKind.boss)
                    bossAnimation = [img("""
                            .............f4.............
                                                    ............f44.............
                                                    .22222......f44.........22..
                                                    2222222.....f44........2222.
                                                    2112222..f.f444......f.2222.
                                                    2f122222f22f444.......f2222.
                                                    2222222222f4444..f..f222222.
                                                    2222222222f44442f2.2f22222..
                                                    .ff2222222f44422222222222...
                                                    ....222222f4442222222222....
                                                    ....2222222222222222222.....
                                                    .....222222222222222........
                                                    ......22222222222...........
                                                    .......2.....2..............
                                                    ......22....22..............
                                                    ......2.....2...............
                                                    .....2.2...2.2..............
                                                    ............................
                        """),
                        img("""
                            ............................
                                                    ............................
                                                    .22222..................22..
                                                    2222222................2222.
                                                    2112222..f...........f.2222.
                                                    2f122222f22...........f2222.
                                                    222222222222.....f..f222222.
                                                    2222222222222f42f2.2f22222..
                                                    .ff22222222ff442222222222...
                                                    ....222222f4444222222222....
                                                    ....2222222222222222222.....
                                                    .....222222222222222........
                                                    ......22222222222...........
                                                    .......2.....2..............
                                                    ......22....22..............
                                                    ......2.....2...............
                                                    .....2.2...2.2..............
                                                    ............................
                        """),
                        img("""
                            ............................
                                                    ............................
                                                    .22222......................
                                                    2222222..................22.
                                                    2112222..f...........f..2222
                                                    2f122222f22...........f22222
                                                    222222222222.....f..f222222.
                                                    2222222222222222f2.2f22222..
                                                    .ff2222222222222222222222...
                                                    ....222222f4442222222222....
                                                    ....222222f444222222222.....
                                                    .....22222f444422222........
                                                    ......2222f444422...........
                                                    .......2..2f444.............
                                                    ......22...f444.............
                                                    ......2.....f44.............
                                                    .....2.2...2f44.............
                                                    .............f4.............
                        """),
                        img("""
                            ............................
                                                    ............................
                                                    .22222..................22..
                                                    2222222................2222.
                                                    2112222..f...........f.2222.
                                                    2f122222f22...........f2222.
                                                    222222222222.....f..f222222.
                                                    2222222222222f42f2.2f22222..
                                                    .ff22222222ff442222222222...
                                                    ....222222f4444222222222....
                                                    ....2222222222222222222.....
                                                    .....222222222222222........
                                                    ......22222222222...........
                                                    .......2.....2..............
                                                    ......22....22..............
                                                    ......2.....2...............
                                                    .....2.2...2.2..............
                                                    ............................
                        """)]
                    tiles.place_on_tile(boss2, value49)
                    tiles.set_tile_at(value49, assets.tile("""
                        transparency8
                    """))
                    sprites.set_data_number(boss2, "health", 10)
                    boss2.vx = -50
    if mySprite.y > 1538 and area == 0:
        scene.set_background_color(10)
    else:
        scene.set_background_color(9)
game.on_update(on_on_update)

def on_on_update2():
    if rune == 2:
        scene.set_background_image(img("""
            ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
                        ................................................................................................................................................................
        """))
        scene.background_image().draw_line(mySprite.x - scene.camera_property(CameraProperty.LEFT),
            mySprite.y - scene.camera_property(CameraProperty.TOP),
            selectedBlock.x - scene.camera_property(CameraProperty.LEFT),
            selectedBlock.y - scene.camera_property(CameraProperty.TOP),
            8)
        mySprite.ax = selectedBlock.x - mySprite.x
        mySprite.ay = selectedBlock.y - mySprite.y
        mySprite.x += mySprite.ax * 0.03
        mySprite.y += mySprite.ay * 0.03
game.on_update(on_on_update2)

def on_on_update3():
    global particle
    for value50 in sprites.all_of_kind(SpriteKind.GroundFan):
        if Math.percent_chance(5):
            if spriteutils.distance_between(mySprite, value50) < 128:
                particle = sprites.create(img("""
                        . . . . 1 . . . . 
                                            . . . . 1 . . . . 
                                            . . . . 1 . . . . 
                                            . . . . 1 . . . . 
                                            . . . . 1 . . . . 
                                            . . . . 1 . . . . 
                                            . . . . 1 . . . . 
                                            . . . . 1 . . . . 
                                            . . . . 1 . . . .
                    """),
                    SpriteKind.FanGust)
                particle.set_velocity(0, -50)
                tiles.place_on_tile(particle, value50.tilemap_location())
                particle.y += -5
                particle.x += randint(-4, 4)
                particle.lifespan = 500
                particle.set_flag(SpriteFlag.AUTO_DESTROY, True)
                particle.set_flag(SpriteFlag.GHOST_THROUGH_TILES, True)
                particle.set_flag(SpriteFlag.GHOST_THROUGH_WALLS, True)
game.on_update(on_on_update3)

def on_forever():
    pass
forever(on_forever)
