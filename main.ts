namespace SpriteKind {
    export const physicsObject = SpriteKind.create()
    export const FanGust = SpriteKind.create()
    export const GroundFan = SpriteKind.create()
    export const Cursor = SpriteKind.create()
    export const boss = SpriteKind.create()
    export const EnemyProj = SpriteKind.create()
}
controller.up.onEvent(ControllerButtonEvent.Pressed, function () {
    if (rune == 0) {
        if (mySprite.isHittingTile(CollisionDirection.Bottom)) {
            inAir = 1
            mySprite.vy = -135
            animation.runImageAnimation(
            mySprite,
            animationJumping,
            50,
            false
            )
        } else {
            if (!(tiles.tileAtLocationIsWall(mySprite.tilemapLocation().getNeighboringLocation(CollisionDirection.Bottom))) && (!(tiles.tileAtLocationIsWall(mySprite.tilemapLocation().getNeighboringLocation(CollisionDirection.Bottom).getNeighboringLocation(CollisionDirection.Bottom))) && !(tiles.tileAtLocationIsWall(mySprite.tilemapLocation().getNeighboringLocation(CollisionDirection.Bottom).getNeighboringLocation(CollisionDirection.Bottom).getNeighboringLocation(CollisionDirection.Bottom)))) && gliding == 0) {
                animation.runImageAnimation(
                mySprite,
                animationPullOutGlider,
                50,
                false
                )
                pause(300)
                gliding = 1
            } else if (gliding == 1) {
                gliding = 0
                animation.stopAnimation(animation.AnimationTypes.All, mySprite)
                mySprite.setImage(img`
                    . 5 5 5 5 5 . 
                    5 4 4 4 4 5 . 
                    . 4 4 4 f . . 
                    . 4 4 4 4 . . 
                    . . 7 6 . . . 
                    . . 6 7 . . . 
                    . 4 7 7 . . . 
                    . . 8 8 . . . 
                    . 6 8 8 8 . . 
                    6 6 6 8 8 8 . 
                    e e . . 8 f f 
                    . e e . f f . 
                    `)
                if (direction == 1) {
                    mySprite.image.flipX()
                }
                mySprite.y += 4
            } else {
            	
            }
        }
    } else if (rune == 2) {
        inAir = 1
        mySprite.vy = -135
        animation.runImageAnimation(
        mySprite,
        animationJumping,
        50,
        false
        )
        scene.setBackgroundImage(img`
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            `)
        rune = 0
        mySprite.vx = 0
        mySprite.ax = 0
        mySprite.ay = 500
        controller.moveSprite(mySprite, 100, 0)
    }
})
function loadMap () {
    mySprite.setImage(img`
        . . . 5 5 5 5 5 5 . . . 
        . . 5 4 4 4 4 5 . . . . 
        . . . 4 4 4 f . . . . . 
        . . . 4 4 4 4 . . . . . 
        . . . . 7 6 . . . . . . 
        . . . . 7 6 . . . . . . 
        . . . . 7 4 . . . . . . 
        . . . . 7 7 . . . . . . 
        . . . . 8 8 . . . . . . 
        . . . . 8 8 . . . . . . 
        . . . . 8 8 . . . . . . 
        . . . . f f f . . . . . 
        `)
    animation.stopAnimation(animation.AnimationTypes.All, mySprite)
    inAir = 0
    gliding = 0
    sprites.destroyAllSpritesOfKind(SpriteKind.Food)
    sprites.destroyAllSpritesOfKind(SpriteKind.Projectile)
    sprites.destroyAllSpritesOfKind(SpriteKind.Enemy)
    sprites.destroyAllSpritesOfKind(SpriteKind.GroundFan)
    sprites.destroyAllSpritesOfKind(SpriteKind.FanGust)
    sprites.destroyAllSpritesOfKind(SpriteKind.physicsObject)
    for (let value of tiles.getTilesByType(assets.tile`myTile27`)) {
        dinosaur = sprites.create(img`
            . 7 7 7 7 . . . . . . . . . . . 
            7 7 7 7 7 7 . . . . . . . . . . 
            7 f 7 7 7 7 . . . . . . . . . . 
            7 7 7 7 7 7 . . . . . . . . . . 
            1 1 7 7 7 7 . . . . . . . . . . 
            . 7 7 7 7 . . . . . . . . . . . 
            . . 7 7 . . . . . . . . . . 6 . 
            . . 7 7 . . . . . . . . . . 7 . 
            . . 7 7 7 . 6 . . . . . . . 7 . 
            7 . 7 7 7 7 7 . 6 . . 6 . 7 7 . 
            . 7 . 7 7 7 7 7 7 . . 7 7 7 . . 
            7 . . 7 7 7 7 7 7 7 7 7 7 . . . 
            . . . . 7 7 7 7 7 7 7 7 . . . . 
            . . . . . . . 7 7 . . . . . . . 
            . . . . . . . 7 7 . . . . . . . 
            . . . . . . 7 7 7 . . . . . . . 
            `, SpriteKind.Enemy)
        dinosaur.vx = -10
        dinosaur.ay = 500
        dinosaur.setPosition(value.x, value.y)
        tiles.setTileAt(value, assets.tile`transparency8`)
        animation.runImageAnimation(
        dinosaur,
        [img`
            . 7 7 7 7 . . . . . . . . . . . 
            7 7 7 7 7 7 . . . . . . . . . . 
            7 f 7 7 7 7 . . . . . . . . . . 
            7 7 7 7 7 7 . . . . . . . . . . 
            1 1 7 7 7 7 . . . . . . . . . . 
            . 7 7 7 7 . . . . . . . . . . . 
            . . 7 7 . . . . . . . . . . 6 . 
            . . 7 7 . . . . . . . . . . 7 . 
            . . 7 7 7 . 6 . . . . . . . 7 . 
            7 . 7 7 7 7 7 . 6 . . 6 . 7 7 . 
            . 7 . 7 7 7 7 7 7 . . 7 7 7 . . 
            7 . . 7 7 7 7 7 7 7 7 7 7 . . . 
            . . . . 7 7 7 7 7 7 7 7 . . . . 
            . . . . . . . 7 7 . . . . . . . 
            . . . . . . . 7 7 . . . . . . . 
            . . . . . . 7 7 7 . . . . . . . 
            `,img`
            . 7 7 7 7 . . . . . . . . . . . 
            7 7 7 7 7 7 . . . . . . . . . . 
            7 f 7 7 7 7 . . . . . . . . . . 
            7 7 7 7 7 7 . . . . . . . . . . 
            1 1 7 7 7 7 . . . . . . . . . . 
            . 7 7 7 7 . . . . . . . . . . . 
            . . 7 7 . . . . . . . . . . 6 . 
            . . 7 7 . . . . . . . . . . 7 . 
            . . 7 7 7 . 6 . . . . . . . 7 . 
            7 . 7 7 7 7 7 . 6 . . 6 . 7 7 . 
            . 7 . 7 7 7 7 7 7 . . 7 7 7 . . 
            7 . . 7 7 7 7 7 7 7 7 7 7 . . . 
            . . . . 7 7 7 7 7 7 7 7 . . . . 
            . . . . . . 7 7 6 6 . . . . . . 
            . . . . 7 . 7 7 . 6 6 . . . . . 
            . . . . . 7 7 . 6 6 6 . . . . . 
            `,img`
            . 7 7 7 7 . . . . . . . . . . . 
            7 7 7 7 7 7 . . . . . . . . . . 
            7 f 7 7 7 7 . . . . . . . . . . 
            7 7 7 7 7 7 . . . . . . . . . . 
            1 1 7 7 7 7 . . . . . . . . . . 
            . 7 7 7 7 . . . . . . . . . . . 
            . . 7 7 . . . . . . . . . . 6 . 
            . . 7 7 . . . . . . . . . . 7 . 
            . . 7 7 7 . 6 . . . . . . . 7 . 
            7 . 7 7 7 7 7 . 6 . . 6 . 7 7 . 
            . 7 . 7 7 7 7 7 7 . . 7 7 7 . . 
            7 . . 7 7 7 7 7 7 7 7 7 7 . . . 
            . . . . 7 7 7 7 7 7 7 7 . . . . 
            . . . . . . . 7 7 . . . . . . . 
            . . . . . . . 7 7 . . . . . . . 
            . . . . . . 7 7 7 . . . . . . . 
            `,img`
            . 7 7 7 7 . . . . . . . . . . . 
            7 7 7 7 7 7 . . . . . . . . . . 
            7 f 7 7 7 7 . . . . . . . . . . 
            7 7 7 7 7 7 . . . . . . . . . . 
            1 1 7 7 7 7 . . . . . . . . . . 
            . 7 7 7 7 . . . . . . . . . . . 
            . . 7 7 . . . . . . . . . . 6 . 
            . . 7 7 . . . . . . . . . . 7 . 
            . . 7 7 7 . 6 . . . . . . . 7 . 
            7 . 7 7 7 7 7 . 6 . . 6 . 7 7 . 
            . 7 . 7 7 7 7 7 7 . . 7 7 7 . . 
            7 . . 7 7 7 7 7 7 7 7 7 7 . . . 
            . . . . 7 7 7 7 7 7 7 7 . . . . 
            . . . . . . 6 6 7 7 . . . . . . 
            . . . . 6 . 6 6 . 7 7 . . . . . 
            . . . . . 6 6 . 7 7 7 . . . . . 
            `],
        500,
        true
        )
    }
    mounted = false
    for (let value of sprites.allOfKind(SpriteKind.physicsObject)) {
        value.x += 128
    }
    tileUtil.createSpritesOnTiles(assets.tile`myTile29`, img`
        . 
        `, SpriteKind.GroundFan)
    for (let value of sprites.allOfKind(SpriteKind.GroundFan)) {
        value.setFlag(SpriteFlag.Ghost, true)
    }
    for (let value of tiles.getTilesByType(assets.tile`myTile35`)) {
        object = sprites.create(img`
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            .66666666666666666666666666666666666666666666666666666666666666.
            6666666666666666666666666666666666666666666666666666666666666666
            6666666666666666666666666666666666666666666666666666666666666666
            .66666666666666666666666666666666666666666666666666666666666666.
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            ................................................................
            `, SpriteKind.physicsObject)
        object.ay = 500
        sprites.setDataString(object, "type", "platform")
        object.setPosition(value.x, value.y)
        tiles.setTileAt(value, assets.tile`transparency8`)
    }
    for (let value of tiles.getTilesByType(assets.tile`myTile33`)) {
        object = sprites.create(img`
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . 6 6 . . . . . . . 
            . . . . . . 6 6 6 6 . . . . . . 
            . b 1 b b 1 b b b b 1 b b 1 b . 
            b 1 b b 1 b b 1 b b b 1 b b 1 b 
            b 1 b b 1 b b 1 b b b 1 b b 1 b 
            . b 1 b b 1 b b b b 1 b b 1 b . 
            . . . . . . . 7 7 . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            . . . . . . . . . . . . . . . . 
            `, SpriteKind.physicsObject)
        object.ay = 500
        sprites.setDataString(object, "type", "fan")
        object.setPosition(value.x, value.y)
        tiles.setTileAt(value, assets.tile`transparency8`)
    }
    for (let value of tiles.getTilesByType(assets.tile`myTile37`)) {
        object = sprites.create(img`
            ..................
            ..................
            ..................
            ...7..........7...
            ..................
            ..7............7..
            ..................
            ..7............7..
            ..................
            ..7............7..
            ..................
            ..7ffffffffffff7..
            ..ff6666666666ff..
            ..f666666666666f..
            ..ff6666666666ff..
            ...ffffffffffff...
            ..................
            ..................
            `, SpriteKind.physicsObject)
        object.ay = 500
        sprites.setDataString(object, "type", "controller (empty)")
        object.setPosition(value.x, value.y)
        tiles.setTileAt(value, assets.tile`transparency8`)
    }
    for (let value of tiles.getTilesByType(assets.tile`myTile38`)) {
        object = sprites.create(img`
            . . . . . . . . . . . . 
            . . f f f f f f f f . . 
            . f f f f f f f f f f . 
            f f f f f f f f f f f f 
            f f 6 8 8 8 8 8 8 6 f f 
            f 6 6 8 8 8 8 8 8 6 6 f 
            . 6 6 8 8 8 8 8 8 6 6 . 
            . 6 6 6 8 8 8 8 6 6 6 . 
            . . 6 6 6 6 6 6 6 6 . . 
            . . . 6 6 6 6 6 6 . . . 
            `, SpriteKind.physicsObject)
        object.ay = 500
        sprites.setDataString(object, "type", "wheel")
        sprites.setDataBoolean(object, "hittingWall", false)
        object.setPosition(value.x, value.y)
        tiles.setTileAt(value, assets.tile`transparency8`)
    }
    for (let value of tiles.getTilesByType(assets.tile`myTile36`)) {
        object = sprites.create(img`
            . . . . . . . 2 2 . . . . . . . 
            . . . . . . 2 f f 2 . . . . . . 
            . . . . . . f f f f . . . . . . 
            . . . . . . f f f f . . . . . . 
            . . . . . . f f f f . . . . . . 
            . . . . . . f 2 2 f . . . . . . 
            . . . . . . 2 f f 2 . . . . . . 
            . . . . . f f c c f f . . . . . 
            . . . . f f f c c f f f . . . . 
            . . . f f f f c c f f f f . . . 
            . . . f f f f a a f f f f . . . 
            . . . f f f f c c f f f f . . . 
            . . . . f f f f f f f f . . . . 
            . . . . . . 6 6 6 6 . . . . . . 
            . . . . . . 6 6 6 6 . . . . . . 
            . . . . . . . 6 6 . . . . . . . 
            `, SpriteKind.physicsObject)
        object.ay = 500
        sprites.setDataString(object, "type", "rocket")
        object.setPosition(value.x, value.y)
        tiles.setTileAt(value, assets.tile`transparency8`)
    }
    if (blockSettings.readNumber("finalBossComplete") == 1) {
        for (let value of tiles.getTilesByType(assets.tile`myTile39`)) {
            tiles.setTileAt(value, assets.tile`transparency8`)
        }
        for (let value of tiles.getTilesByType(assets.tile`myTile42`)) {
            tiles.setTileAt(value, assets.tile`transparency8`)
        }
        for (let value of tiles.getTilesByType(assets.tile`myTile43`)) {
            tiles.setTileAt(value, assets.tile`transparency8`)
        }
        for (let value of tiles.getTilesByType(assets.tile`myTile44`)) {
            tiles.setTileAt(value, assets.tile`transparency8`)
        }
        for (let value of tiles.getTilesByType(assets.tile`myTile45`)) {
            tiles.setTileAt(value, assets.tile`transparency8`)
        }
        for (let value of tiles.getTilesByType(assets.tile`myTile46`)) {
            tiles.setTileAt(value, assets.tile`transparency8`)
        }
        for (let value of tiles.getTilesByType(assets.tile`myTile47`)) {
            tiles.setTileAt(value, assets.tile`transparency8`)
        }
    } else {
        for (let value of tiles.getTilesByType(assets.tile`myTile41`)) {
            tiles.setTileAt(value, assets.tile`transparency16`)
        }
    }
}
function holdObject (object: Sprite) {
    if (rune == 1) {
        partOfObject = false
        for (let value of allConnections) {
            if (value.indexOf(object) > 0) {
                value.unshift(value.removeAt(value.indexOf(object)))
            }
            if (value.indexOf(object) >= 0) {
                partOfObject = true
            }
        }
        if (controller.A.isPressed()) {
            if (!(controller.B.isPressed())) {
                holdingState = 0
                for (let value of sprites.allOfKind(SpriteKind.physicsObject)) {
                    if (overlapsWithArray(object, value)) {
                        connect = true
                        for (let value2 of allConnections) {
                            if (value2.indexOf(object) != -1 && value2.indexOf(value) != -1) {
                                connect = false
                            }
                        }
                        if (connect) {
                            allConnections.push([])
                            for (let value2 of allConnections) {
                                if (value2.indexOf(object) != -1) {
                                    for (let value3 of value2) {
                                        if (value3 != object) {
                                            allConnections[allConnections.length - 1].push(value3)
                                            sprites.setDataNumber(value3, "offsetX", Math.round(value3.x - object.x))
                                            sprites.setDataNumber(value3, "offsetY", Math.round(value3.y - object.y))
                                        }
                                    }
                                    allConnections.removeAt(allConnections.indexOf(value2))
                                    break;
                                }
                            }
                            for (let value2 of allConnections) {
                                if (value2.indexOf(value) != -1) {
                                    for (let value3 of value2) {
                                        if (value3 != value) {
                                            allConnections[allConnections.length - 1].push(value3)
                                            sprites.setDataNumber(value3, "offsetX", Math.round(value3.x - object.x))
                                            sprites.setDataNumber(value3, "offsetY", Math.round(value3.y - object.y))
                                        }
                                    }
                                    allConnections.removeAt(allConnections.indexOf(value2))
                                    break;
                                }
                            }
                            allConnections[allConnections.length - 1].unshift(value)
                            allConnections[allConnections.length - 1].unshift(object)
                            sprites.setDataNumber(object, "offsetX", 0)
                            sprites.setDataNumber(object, "offsetY", 0)
                            sprites.setDataNumber(value, "offsetX", Math.round(value.x - object.x))
                            sprites.setDataNumber(value, "offsetY", Math.round(value.y - object.y))
                            break;
                        }
                    }
                }
                sprites.destroy(cursor)
                object.ay = 500
                controller.moveSprite(object, 0, 0)
                object.setFlag(SpriteFlag.StayInScreen, false)
                pauseUntil(() => !(controller.A.isPressed()))
                rune = 0
                return
            } else {
                holdingState = 0
                branches = []
                for (let value of allConnections) {
                    if (value.indexOf(object) != -1) {
                        for (let value2 of value) {
                            if (value2.overlapsWith(object)) {
                                branches.push([value2])
                                sprites.setDataNumber(value2, "offsetX", 0)
                                sprites.setDataNumber(value2, "offsetY", 0)
                                for (let index = 0; index <= value.length - 1; index++) {
                                    for (let value3 of value) {
                                        for (let value4 of branches[branches.length - 1]) {
                                            if (value3.overlapsWith(value4)) {
                                                if (branches[branches.length - 1].indexOf(value3) == -1 && value3 != object) {
                                                    branches[branches.length - 1].push(value3)
                                                    sprites.setDataNumber(value3, "offsetX", Math.round(value3.x - value2.x))
                                                    sprites.setDataNumber(value3, "offsetY", Math.round(value3.y - value2.y))
                                                }
                                            }
                                        }
                                    }
                                }
                                for (let value3 of branches) {
                                    if (value3.length == branches[branches.length - 1].length && branches[branches.length - 1] != value3) {
                                        for (let value4 of value3) {
                                            if (branches[branches.length - 1].indexOf(value4) == -1) {
                                                break;
                                            }
                                            if (value4 == branches[branches.length - 1][branches[branches.length - 1].length - 1]) {
                                                branches.removeAt(branches.indexOf(value3))
                                            }
                                        }
                                    }
                                }
                            }
                        }
                        allConnections.removeAt(allConnections.indexOf(value))
                    }
                }
                for (let value2 of branches) {
                    if (value2.length > 1) {
                        allConnections.push(value2)
                    } else {
                        value2[0].ay = 500
                        controller.moveSprite(value2[0], 0, 0)
                        value2[0].setFlag(SpriteFlag.StayInScreen, false)
                    }
                }
                sprites.destroy(cursor)
                object.ay = 500
                controller.moveSprite(object, 0, 0)
                object.setFlag(SpriteFlag.StayInScreen, false)
                pauseUntil(() => !(controller.A.isPressed()))
                rune = 0
                return
            }
        }
        cursor.setPosition(object.x, object.y)
        object.ay = 0
        if (controller.left.isPressed()) {
            object.x += -0.5
        }
        if (controller.right.isPressed()) {
            object.x += 0.5
        }
        if (controller.up.isPressed()) {
            object.y += -0.5
        }
        if (controller.down.isPressed()) {
            object.y += 0.5
        }
        if (controller.B.isPressed() && !(partOfObject)) {
            if (controller.left.isPressed()) {
                transformSprites.changeRotation(object, -45)
                pauseUntil(() => !(controller.left.isPressed()))
            }
            if (controller.right.isPressed()) {
                transformSprites.changeRotation(object, 45)
                pauseUntil(() => !(controller.right.isPressed()))
            }
        }
        timer.background(function () {
            pause(0)
            holdObject(object)
        })
    }
}
controller.B.onEvent(ControllerButtonEvent.Pressed, function () {
    if (rune == 0 && !(mounted)) {
        if (tiles.getTilesByType(assets.tile`myTile28`).length > 0) {
            selectedBlock = tiles.getTilesByType(assets.tile`myTile28`)[0]
            if (mySprite.vx > 0) {
                posX = mySprite.x + 64
            } else if (mySprite.vx < 0) {
                posX = mySprite.x - 64
            } else {
                posX = mySprite.x
            }
            posY = mySprite.y - 32
            for (let value of tiles.getTilesByType(assets.tile`myTile28`)) {
                if (selectedBlock) {
                    if (Math.sqrt((posX - value.x) ** 2 + (posY - value.y) ** 2) < 128 && Math.sqrt((posX - value.x) ** 2 + (posY - value.y) ** 2) < Math.sqrt((posX - selectedBlock.x) ** 2 + (posY - selectedBlock.y) ** 2)) {
                        selectedBlock = value
                    }
                } else {
                    selectedBlock = value
                }
            }
            if (Math.sqrt((posX - selectedBlock.x) ** 2 + (posY - selectedBlock.y) ** 2) < 128) {
                rune = 2
                gliding = 0
                mySprite.setImage(img`
                    . . . 5 5 5 5 5 5 . . . 
                    . . 5 4 4 4 4 5 . . . . 
                    . . . 4 4 4 f . . . . . 
                    . . . 4 4 4 4 . . . . . 
                    . . . . 7 6 . . . . . . 
                    . . . . 7 6 . . . . . . 
                    . . . . 7 4 . . . . . . 
                    . . . . 7 7 . . . . . . 
                    . . . . 8 8 . . . . . . 
                    . . . . 8 8 . . . . . . 
                    . . . . 8 8 . . . . . . 
                    . . . . f f f . . . . . 
                    `)
                if (direction == 0) {
                    mySprite.image.flipX()
                }
                controller.moveSprite(mySprite, 0, 0)
            }
        }
    } else if (rune == 2) {
        scene.setBackgroundImage(img`
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            `)
        rune = 0
        mySprite.vx = 0
        mySprite.ax = 0
        mySprite.ay = 500
        controller.moveSprite(mySprite, 100, 0)
    }
})
scene.onHitWall(SpriteKind.physicsObject, function (sprite, location) {
    for (let value of allConnections) {
        if (value.indexOf(sprite) != -1) {
            for (let value2 of value) {
                sprites.setDataNumber(value2, "constructGravity", 0)
            }
        }
    }
})
scene.onOverlapTile(SpriteKind.Player, assets.tile`myTile34`, function (sprite, location) {
    tiles.setCurrentTilemap(tileUtil.createSmallMap(tilemap`level1`))
    info.setLife(blockSettings.readNumber("maxHealth"))
    area = 0
    loadMap()
    tiles.placeOnTile(mySprite, prevPos)
})
scene.onOverlapTile(SpriteKind.Player, assets.tile`myTile32`, function (sprite, location) {
    tiles.setCurrentTilemap(tileUtil.createSmallMap(tilemap`level1`))
    list = blockSettings.readNumberArray("areasCleared")
    list.push(area)
    blockSettings.writeNumberArray("areasCleared", list)
    blockSettings.writeNumber("maxHealth", blockSettings.readNumber("maxHealth") + 1)
    info.setLife(blockSettings.readNumber("maxHealth"))
    mySprite.x += 0
    area = 0
    loadMap()
    tiles.placeOnTile(mySprite, prevPos)
})
controller.A.onEvent(ControllerButtonEvent.Pressed, function () {
    if (!(mounted)) {
        if (rune == 0) {
            if (direction == 0) {
                projectile = sprites.createProjectileFromSprite(img`
                    . . . . . . . 1 1 . . . 
                    . . . . . . . . 1 1 . . 
                    . . . . . . . . . 1 1 . 
                    . . . . . . . . . . 1 1 
                    . . . . . . . . . . 1 1 
                    . . . . . . . . . . 1 1 
                    . . . . . . . . . . 1 1 
                    . . . . . . . . . . 1 1 
                    . . . . . . . . . . 1 1 
                    . . . . . . . . . 1 1 . 
                    . . . . . . . . 1 1 . . 
                    . . . . . . . 1 1 . . . 
                    `, mySprite, 0, 0)
                projectile.x += 10
                projectile.setFlag(SpriteFlag.AutoDestroy, true)
                projectile.setFlag(SpriteFlag.DestroyOnWall, true)
                animation.runImageAnimation(
                projectile,
                [img`
                    . . . . 1 1 . 1 1 . . . 
                    . . . 1 d 1 . . 1 . . . 
                    . . 1 d 1 . . . . . . . 
                    . e 1 1 . . . . . . . . 
                    . e e . . . . . . . . . 
                    e . . . . . . . . . . . 
                    . . . . . . . . . . . . 
                    . . . . . . . . . . . . 
                    . . . . . . . . . . . . 
                    . . . . . . . . . . . . 
                    . . . . . . . . . . . . 
                    . . . . . . . . . . . . 
                    `,img`
                    . . . . . . . 1 1 . . . 
                    . . . . . . . . 1 1 . . 
                    . . . . . . . . . 1 1 . 
                    . . . . . . . . . . 1 1 
                    . . . . . . . . . . 1 1 
                    . . 1 1 1 1 1 . . . 1 1 
                    e e 1 d d d d 1 . . 1 1 
                    . . 1 1 1 1 1 . . . 1 . 
                    . . . . . . . . . . . . 
                    . . . . . . . . . . . . 
                    . . . . . . . . . . . . 
                    . . . . . . . . . . . . 
                    `,img`
                    . . . . . . . 1 1 . . . 
                    . . . . . . . . 1 1 . . 
                    . . . . . . . . . 1 1 . 
                    . . . . . . . . . . 1 1 
                    . . . . . . . . . . 1 1 
                    . . . . . . . . . . 1 1 
                    e . . . . . . . . . 1 1 
                    . e e . . . . . . . 1 1 
                    . e 1 1 . . . . . . 1 1 
                    . . 1 1 1 . . . . 1 1 . 
                    . . . 1 1 1 . . 1 1 . . 
                    . . . . 1 1 . 1 1 . . . 
                    `,img`
                    . . . . . . . 1 1 . . . 
                    . . . . . . . . 1 1 . . 
                    . . . . . . . . . 1 1 . 
                    . . . . . . . . . . 1 1 
                    . . . . . . . . . . 1 1 
                    . . . . . . . . . . 1 1 
                    . . . . . . . . . . 1 1 
                    . . . . . . . . . . 1 1 
                    . . . . . . . . . . 1 1 
                    . . . . . . . . . 1 1 . 
                    . . . . . . . . 1 1 . . 
                    . . . . . . . 1 1 . . . 
                    `],
                50,
                false
                )
                timer.after(150, function () {
                    projectile.vx = 50
                })
            } else {
                projectile = sprites.createProjectileFromSprite(img`
                    . . . 1 1 . . . . . . . 
                    . . 1 1 . . . . . . . . 
                    . 1 1 . . . . . . . . . 
                    1 1 . . . . . . . . . . 
                    1 1 . . . . . . . . . . 
                    1 1 . . . . . . . . . . 
                    1 1 . . . . . . . . . . 
                    1 1 . . . . . . . . . . 
                    1 1 . . . . . . . . . . 
                    . 1 1 . . . . . . . . . 
                    . . 1 1 . . . . . . . . 
                    . . . 1 1 . . . . . . . 
                    `, mySprite, 0, 0)
                projectile.x += -10
                projectile.setFlag(SpriteFlag.AutoDestroy, true)
                projectile.setFlag(SpriteFlag.DestroyOnWall, true)
                animation.runImageAnimation(
                projectile,
                [img`
                    . . . 1 1 . 1 1 . . . . 
                    . . . 1 . . 1 d 1 . . . 
                    . . . . . . . 1 d 1 . . 
                    . . . . . . . . 1 1 e . 
                    . . . . . . . . . e e . 
                    . . . . . . . . . . . e 
                    . . . . . . . . . . . . 
                    . . . . . . . . . . . . 
                    . . . . . . . . . . . . 
                    . . . . . . . . . . . . 
                    . . . . . . . . . . . . 
                    . . . . . . . . . . . . 
                    `,img`
                    . . . 1 1 . . . . . . . 
                    . . 1 1 . . . . . . . . 
                    . 1 1 . . . . . . . . . 
                    1 1 . . . . . . . . . . 
                    1 1 . . . . . . . . . . 
                    1 1 . . . 1 1 1 1 1 . . 
                    1 1 . . 1 d d d d 1 e e 
                    . 1 . . . 1 1 1 1 1 . . 
                    . . . . . . . . . . . . 
                    . . . . . . . . . . . . 
                    . . . . . . . . . . . . 
                    . . . . . . . . . . . . 
                    `,img`
                    . . . 1 1 . . . . . . . 
                    . . 1 1 . . . . . . . . 
                    . 1 1 . . . . . . . . . 
                    1 1 . . . . . . . . . . 
                    1 1 . . . . . . . . . . 
                    1 1 . . . . . . . . . . 
                    1 1 . . . . . . . . . e 
                    1 1 . . . . . . . e e . 
                    1 1 . . . . . . 1 1 e . 
                    . 1 1 . . . . 1 1 1 . . 
                    . . 1 1 . . 1 1 1 . . . 
                    . . . 1 1 . 1 1 . . . . 
                    `,img`
                    . . . 1 1 . . . . . . . 
                    . . 1 1 . . . . . . . . 
                    . 1 1 . . . . . . . . . 
                    1 1 . . . . . . . . . . 
                    1 1 . . . . . . . . . . 
                    1 1 . . . . . . . . . . 
                    1 1 . . . . . . . . . . 
                    1 1 . . . . . . . . . . 
                    1 1 . . . . . . . . . . 
                    . 1 1 . . . . . . . . . 
                    . . 1 1 . . . . . . . . 
                    . . . 1 1 . . . . . . . 
                    `],
                50,
                false
                )
                timer.after(150, function () {
                    projectile.vx = -50
                })
            }
        } else if (rune == 1) {
            if (controller.B.isPressed()) {
                if (holdingState == 0) {
                    sprites.destroy(cursor)
                    for (let value of sprites.allOfKind(SpriteKind.physicsObject)) {
                        value.ay = 500
                        controller.moveSprite(value, 0, 0)
                        value.setFlag(SpriteFlag.StayInScreen, false)
                    }
                    rune = 0
                }
                pauseUntil(() => !(controller.A.isPressed()))
            }
        }
    }
})
scene.onOverlapTile(SpriteKind.Player, assets.tile`myTile7`, function (sprite, location) {
    timer.throttle("idk", 500, function () {
        info.changeLifeBy(-1)
    })
})
sprites.onOverlap(SpriteKind.Player, SpriteKind.FanGust, function (sprite, otherSprite) {
    if (rune == 0 && gliding == 0) {
        animation.runImageAnimation(
        mySprite,
        animationPullOutGlider,
        50,
        false
        )
        pause(300)
        gliding = 1
        mySprite.vy = -135
    } else {
        if (mySprite.vy > 0) {
            mySprite.vy = 0
        }
        if (mySprite.vy > -150) {
            mySprite.vy += -40
        }
    }
})
controller.combos.attachCombo("" + controller.combos.idToString(controller.combos.ID.down) + controller.combos.idToString(controller.combos.ID.down), function () {
    if (rune == 0 && !(mounted)) {
        initiateHand()
    }
})
sprites.onOverlap(SpriteKind.Food, SpriteKind.Player, function (sprite, otherSprite) {
    if (info.life() < blockSettings.readNumber("maxHealth")) {
        info.changeLifeBy(1)
        sprites.destroy(sprite)
    }
})
scene.onOverlapTile(SpriteKind.Player, assets.tile`myTile16`, function (sprite, location) {
    if ((mySprite.tileKindAt(TileDirection.Center, assets.tile`myTile16`) || mySprite.tileKindAt(TileDirection.Top, assets.tile`myTile16`)) && rune == 0) {
        mySprite.sayText("Press A to interact", 50, false)
        if (controller.A.isPressed()) {
            if (mySprite.tilemapLocation().column == 22) {
                prevPos = mySprite.tilemapLocation()
                tiles.setCurrentTilemap(tileUtil.createSmallMap(tilemap`level5`))
                tiles.placeOnTile(mySprite, tiles.getTileLocation(2, 10))
                area = 1
                loadMap()
            } else if (mySprite.tilemapLocation().column == 139) {
                prevPos = mySprite.tilemapLocation()
                tiles.setCurrentTilemap(tileUtil.createSmallMap(tilemap`level14`))
                tiles.placeOnTile(mySprite, tiles.getTileLocation(2, 28))
                area = 2
                loadMap()
            } else if (mySprite.tilemapLocation().column == 64) {
                prevPos = mySprite.tilemapLocation()
                tiles.setCurrentTilemap(tileUtil.createSmallMap(tilemap`level18`))
                tiles.placeOnTile(mySprite, tiles.getTileLocation(2, 10))
                area = 3
                loadMap()
            } else if (mySprite.tilemapLocation().column == 220) {
                prevPos = mySprite.tilemapLocation()
                tiles.setCurrentTilemap(tileUtil.createSmallMap(tilemap`level23`))
                tiles.placeOnTile(mySprite, tiles.getTileLocation(2, 124))
                area = 4
                loadMap()
            } else if (mySprite.tilemapLocation().column == 140) {
                prevPos = mySprite.tilemapLocation()
                tiles.setCurrentTilemap(tileUtil.createSmallMap(tilemap`level26`))
                tiles.placeOnTile(mySprite, tiles.getTileLocation(2, 60))
                area = 5
                loadMap()
            } else {
            	
            }
            list = blockSettings.readNumberArray("areasCleared")
            if (list.indexOf(area) != -1) {
                tileUtil.replaceAllTiles(assets.tile`myTile32`, assets.tile`myTile34`)
            }
            pauseUntil(() => !(controller.A.isPressed()))
        }
    }
})
scene.onHitWall(SpriteKind.Enemy, function (sprite, location) {
	
})
sprites.onOverlap(SpriteKind.Enemy, SpriteKind.Player, function (sprite, otherSprite) {
    timer.throttle("idk", 500, function () {
        info.changeLifeBy(-1)
    })
})
function initiateHand () {
    rune = 1
    cursor = sprites.create(img`
        . . 1 . . 
        . . 1 . . 
        1 1 1 1 1 
        . . 1 . . 
        . . 1 . . 
        `, SpriteKind.Cursor)
    controller.moveSprite(cursor)
    cursor.setStayInScreen(true)
}
spriteutils.addEventHandler(spriteutils.UpdatePriorityModifier.Before, spriteutils.UpdatePriority.Camera, function () {
    for (let value of allConnections) {
        finalX = 0
        finalY = 0
        for (let value2 of value) {
            if (sprites.readDataString(value2, "type") == "controller (occupied)") {
                finalX = velocityChangeX
                finalY = velocityChangeY
            }
            value2.ax = 0
            value2.ay = 0
            value2.vx = 0
            value2.vy = 0
        }
        if (velocityChangeY < 0 || rune == 1) {
            for (let value3 of value) {
                sprites.setDataNumber(value3, "constructGravity", 0)
            }
        } else {
            for (let value3 of value) {
                sprites.changeDataNumberBy(value3, "constructGravity", 0.2)
            }
        }
        for (let value3 of value) {
            sprites.setDataNumber(value3, "constructGravity", Math.constrain(sprites.readDataNumber(value3, "constructGravity"), 0, 20))
        }
        if (rune == 0) {
            finalY += sprites.readDataNumber(value[0], "constructGravity")
        }
        loop = Math.max(Math.floor(Math.abs(finalX / 4)), Math.floor(Math.abs(finalY / 4)))
        for (let index = 0; index <= loop; index++) {
            if (finalX >= 4) {
                for (let value3 of value) {
                    value3.x += 4
                }
                finalX += -4
            } else if (finalX <= -4) {
                for (let value3 of value) {
                    value3.x += -4
                }
                finalX += 4
            }
            if (finalY >= 4) {
                for (let value3 of value) {
                    value3.y += 4
                }
                finalY += -4
            } else if (finalY <= -4) {
                for (let value3 of value) {
                    value3.y += -4
                }
                finalY += 4
            }
            for (let index2 = 0; index2 <= value.length; index2++) {
                for (let value2 of value) {
                    value2.setPosition(value[0].x - sprites.readDataNumber(value[0], "offsetX") + sprites.readDataNumber(value2, "offsetX"), value[0].y - sprites.readDataNumber(value[0], "offsetY") + sprites.readDataNumber(value2, "offsetY"))
                }
                value.push(value.shift())
            }
        }
        for (let value3 of value) {
            value3.x += finalX
            value3.y += finalY
        }
        for (let index2 = 0; index2 <= value.length; index2++) {
            for (let value2 of value) {
                value2.setPosition(value[0].x - sprites.readDataNumber(value[0], "offsetX") + sprites.readDataNumber(value2, "offsetX"), value[0].y - sprites.readDataNumber(value[0], "offsetY") + sprites.readDataNumber(value2, "offsetY"))
                if (sprites.readDataString(value2, "type") == "controller (occupied)") {
                    mySprite.setPosition(value2.x, value2.y - 1)
                    transformSprites.rotateSprite(mySprite, transformSprites.getRotation(value2))
                }
            }
            value.push(value.shift())
        }
    }
})
controller.down.onEvent(ControllerButtonEvent.Pressed, function () {
	
})
function overlapsWithArray (spriteWithArray: Sprite, otherSprite: Sprite) {
    for (let value of allConnections) {
        if (value.indexOf(spriteWithArray) != -1) {
            for (let value2 of value) {
                if (value2.overlapsWith(otherSprite) && value.indexOf(otherSprite) == -1) {
                    return true
                }
            }
            return false
        }
    }
    if (spriteWithArray.overlapsWith(otherSprite)) {
        return true
    } else {
        return false
    }
}
sprites.onOverlap(SpriteKind.Projectile, SpriteKind.boss, function (sprite, otherSprite) {
    sprites.changeDataNumberBy(otherSprite, "health", -1)
    sprites.destroy(sprite)
    scene.cameraShake(4, 500)
    if (sprites.readDataNumber(otherSprite, "health") <= 0) {
        sprites.destroy(otherSprite)
        blockSettings.writeNumber("finalBossComplete", 1)
        game.showLongText("You defeated the dragon! You travel back to your home and realize... something that happened while your cat was captured gave it time-travelling powers! So you and your cat can now travel between past and present. (Present time isn't available in this game though!)", DialogLayout.Full)
        game.gameOver(true)
    }
})
scene.onOverlapTile(SpriteKind.Player, assets.tile`myTile10`, function (sprite, location) {
    if (mySprite.tileKindAt(TileDirection.Center, assets.tile`myTile10`) && rune == 0) {
        mySprite.sayText("Press A to read", 50, false)
        if (controller.A.isPressed()) {
            if (area == 0) {
                if (mySprite.tilemapLocation().column == 11) {
                    game.showLongText("Press < and > to move.", DialogLayout.Bottom)
                } else if (mySprite.tilemapLocation().column == 13) {
                    game.showLongText("Press ^ to jump.", DialogLayout.Bottom)
                } else if (mySprite.tilemapLocation().column == 85) {
                    game.showLongText("HINT: Gain enough height to swipe at the dragon!", DialogLayout.Bottom)
                } else {
                	
                }
            } else if (area == 1) {
                if (mySprite.tilemapLocation().column == 2) {
                    game.showLongText("Press A to swing your sword. It will send out a wave, destroying enemies.", DialogLayout.Bottom)
                } else if (mySprite.tilemapLocation().column == 56) {
                    game.showLongText("Collecting big hearts sends you out of the portal and increases your max health.", DialogLayout.Bottom)
                } else if (mySprite.tilemapLocation().column == 36) {
                    game.showLongText("Small hearts that heal 1 heart each can appear upon defeating enemies.", DialogLayout.Bottom)
                } else {
                	
                }
            } else if (area == 2) {
                if (mySprite.tilemapLocation().column == 2) {
                    game.showLongText("Press ^ while you are in the air to pull out your glider.", DialogLayout.Bottom)
                } else if (mySprite.tilemapLocation().column == 14) {
                    game.showLongText("Gusts of air will make you pull out your glider and can help you gain altitude.", DialogLayout.Bottom)
                } else if (mySprite.tilemapLocation().column == 56) {
                    game.showLongText("Now fly left to the beginning of the stage!", DialogLayout.Bottom)
                } else {
                	
                }
            } else if (area == 3) {
                if (mySprite.tilemapLocation().column == 3) {
                    game.showLongText("Press \\/ twice to activate merge. Press A to grab something, arrows to move, and A again to let go. If the selected object overlaps with another object, it will attach to that object.", DialogLayout.Full)
                    game.showLongText("Hold B and click < or > to rotate objects that are not connected to other objects (if an object is connected to another, its rotation can't be changed). You can also hold B and press A to detach the selected object from all overlaping objects.", DialogLayout.Full)
                } else if (mySprite.tilemapLocation().column == 17) {
                    game.showLongText("Wheels are great for making cars and controllable contraptions.", DialogLayout.Bottom)
                } else if (mySprite.tilemapLocation().column == 21) {
                    game.showLongText("Attach a controller to a construct to make a construct work. Press A near the contoller to get in.", DialogLayout.Full)
                } else if (mySprite.tilemapLocation().column == 10) {
                    game.showLongText("Platforms are a great central building point of vehicles.", DialogLayout.Bottom)
                } else if (mySprite.tilemapLocation().column == 43) {
                    game.showLongText("Fans are useful for vertical travel. Unlike wheels, you cannot control them during flight.", DialogLayout.Full)
                } else {
                	
                }
            } else if (area == 4) {
                if (mySprite.tilemapLocation().column == 2) {
                    game.showLongText("Rockets can help you to fly super far!", DialogLayout.Bottom)
                    game.showLongText("HINT: Rotate the rocket to face the top-right so your construct can more easily reach the ledge. (remember to hold B and press A to detach, and hold B and use < or > to rotate).", DialogLayout.Full)
                }
            } else if (area == 5) {
                if (mySprite.tilemapLocation().column == 2) {
                    game.showLongText("Use your gravity-pull ability with B to float towards a nearby point! Then, press B to cancel.", DialogLayout.Full)
                } else if (mySprite.tilemapLocation().column == 23) {
                    game.showLongText("Press ^ to jump and ^ again to glide our of a gravity point.", DialogLayout.Full)
                } else {
                	
                }
            } else {
            	
            }
            pauseUntil(() => !(controller.A.isPressed()))
        }
        if (true) {
        	
        }
    }
})
sprites.onCreated(SpriteKind.boss, function (sprite) {
    timer.background(function () {
        for (let index = 0; index <= 4; index++) {
            if (sprites.readDataNumber(sprite, "health") > 0) {
                index = 0
                sprite.vx = 0 - sprite.vx
                for (let value of bossAnimation) {
                    value.flipX()
                }
                animation.runImageAnimation(
                boss,
                bossAnimation,
                500,
                true
                )
                pause(4000)
            }
        }
    })
    timer.background(function () {
        for (let index = 0; index <= 4; index++) {
            if (sprites.readDataNumber(sprite, "health") > 0) {
                index = 0
                projectile = sprites.createProjectileFromSprite(img`
                    . . . . 2 2 . . . . 
                    . . 2 2 2 2 2 2 . . 
                    . 2 2 2 2 2 2 2 2 . 
                    . 2 2 2 2 2 2 2 2 . 
                    2 2 2 2 2 2 2 2 2 2 
                    2 2 2 2 2 2 2 2 2 2 
                    . 2 2 2 2 2 2 2 2 . 
                    . 2 2 2 2 2 2 2 2 . 
                    . . 2 2 2 2 2 2 . . 
                    . . . . 2 2 . . . . 
                    `, sprite, Math.cos(spriteutils.angleFrom(sprite, mySprite)) * 25, Math.sin(spriteutils.angleFrom(sprite, mySprite)) * 25)
                projectile.setKind(SpriteKind.Enemy)
                projectile.setFlag(SpriteFlag.AutoDestroy, false)
                projectile.setFlag(SpriteFlag.DestroyOnWall, true)
                projectile.lifespan = 2000
                pause(1000)
            }
        }
    })
})
sprites.onOverlap(SpriteKind.Projectile, SpriteKind.Enemy, function (sprite, otherSprite) {
    sprites.destroy(sprite)
    if (Math.percentChance(25)) {
        heartSprite = sprites.create(img`
            . 2 . 2 . 
            2 2 2 2 2 
            2 2 2 2 2 
            . 2 2 2 . 
            . . 2 . . 
            `, SpriteKind.Food)
        heartSprite.setPosition(otherSprite.x, otherSprite.y)
        heartSprite.ay = 500
    }
    sprites.destroy(otherSprite)
})
scene.onOverlapTile(SpriteKind.Player, assets.tile`myTile23`, function (sprite, location) {
    if (rune == 0) {
        mySprite.sayText("Press A to heal", 50, false)
        if (controller.A.isPressed()) {
            info.setLife(blockSettings.readNumber("maxHealth"))
        }
    }
})
let particle: Sprite = null
let heartSprite: Sprite = null
let boss: Sprite = null
let bossAnimation: Image[] = []
let loop = 0
let velocityChangeY = 0
let velocityChangeX = 0
let finalY = 0
let finalX = 0
let projectile: Sprite = null
let list: number[] = []
let prevPos: tiles.Location = null
let area = 0
let posY = 0
let posX = 0
let selectedBlock: tiles.Location = null
let branches: Sprite[][] = []
let cursor: Sprite = null
let connect = false
let holdingState = 0
let partOfObject = false
let object: Sprite = null
let mounted = false
let dinosaur: Sprite = null
let gliding = 0
let inAir = 0
let rune = 0
let allConnections: Sprite[][] = []
let tileImg: Image = null
let animationPullOutGlider: Image[] = []
let animationJumping: Image[] = []
let direction = 0
let mySprite: Sprite = null
if (!(blockSettings.exists("maxHealth"))) {
    game.showLongText("You wake up one day, only to find that your cat is gone and the world has been littered with mysterious portals and technology. The sun is brighter and dinosaurs now roam the area. Your ancient house (no one knows when it was built) looks new again.", DialogLayout.Full)
    game.showLongText("The dissappearence of the cat and the changes to the area must have a connection, you think to yourself. You decide to explore and find evidence about where your cat went.", DialogLayout.Full)
    blockSettings.writeNumber("maxHealth", 3)
    blockSettings.writeNumber("finalBossComplete", 0)
    blockSettings.writeNumberArray("areasCleared", [])
}
info.setLife(blockSettings.readNumber("maxHealth"))
stats.turnStats(true)
scene.setBackgroundColor(9)
scene.setBackgroundImage(img`
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    ................................................................................................................................................................
    `)
mySprite = sprites.create(img`
    . . . 5 5 5 5 5 5 . . . 
    . . 5 4 4 4 4 5 . . . . 
    . . . 4 4 4 f . . . . . 
    . . . 4 4 4 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 4 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . . f f f . . . . . 
    `, SpriteKind.Player)
mySprite.z = 1
scene.cameraFollowSprite(mySprite)
direction = 0
let animationWalking = [img`
    . . . 5 5 5 5 5 5 . . . 
    . . 5 4 4 4 4 5 . . . . 
    . . . 4 4 4 f . . . . . 
    . . . 4 4 4 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 4 7 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . 6 8 8 . . . . . . 
    . . . 6 8 8 . . . . . . 
    . . . e f f f . . . . . 
    `,img`
    . . . . . . . . . . . . 
    . . . 5 5 5 5 5 5 . . . 
    . . 5 4 4 4 4 5 . . . . 
    . . . 4 4 4 f . . . . . 
    . . . 4 4 4 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 6 7 . . . . . . 
    . . . . 4 7 . . . . . . 
    . . . 6 8 8 8 . . . . . 
    . . 6 6 6 8 8 8 . . . . 
    . . e e . . 8 f f . . . 
    . . . e e . f f . . . . 
    `,img`
    . . . 5 5 5 5 5 5 . . . 
    . . 5 4 4 4 4 5 . . . . 
    . . . 4 4 4 f . . . . . 
    . . . 4 4 4 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 4 7 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . 6 8 8 . . . . . . 
    . . . 6 8 8 . . . . . . 
    . . . e f f f . . . . . 
    `,img`
    . . . 5 5 5 5 5 5 . . . 
    . . 5 4 4 4 4 5 . . . . 
    . . . 4 4 4 f . . . . . 
    . . . 4 4 4 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 4 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . . f f f . . . . . 
    `,img`
    . . . 5 5 5 5 5 5 . . . 
    . . 5 4 4 4 4 5 . . . . 
    . . . 4 4 4 f . . . . . 
    . . . 4 4 4 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 7 4 . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . 8 8 6 . . . . . . 
    . . . 8 8 6 . . . . . . 
    . . . f f f e . . . . . 
    `,img`
    . . . . . . . . . . . . 
    . . . 5 5 5 5 5 5 . . . 
    . . 5 4 4 4 4 5 . . . . 
    . . . 4 4 4 f . . . . . 
    . . . 4 4 4 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 7 6 . . . . . 
    . . . . 7 7 4 . . . . . 
    . . . 8 8 8 6 . . . . . 
    . . 8 8 8 6 6 6 . . . . 
    . . f f . . 6 e e . . . 
    . . . f f . e e . . . . 
    `,img`
    . . . 5 5 5 5 5 5 . . . 
    . . 5 4 4 4 4 5 . . . . 
    . . . 4 4 4 f . . . . . 
    . . . 4 4 4 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 7 4 . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . 8 8 6 . . . . . . 
    . . . 8 8 6 . . . . . . 
    . . . f f f e . . . . . 
    `,img`
    . . . 5 5 5 5 5 5 . . . 
    . . 5 4 4 4 4 5 . . . . 
    . . . 4 4 4 f . . . . . 
    . . . 4 4 4 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 4 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . . f f f . . . . . 
    `]
animationJumping = [img`
    . . . . . . . . . . . . 
    . . . 5 5 5 5 5 5 . . . 
    . . 5 4 4 4 4 5 . . . . 
    . . . 4 4 4 f . . . . . 
    . . . 4 4 4 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 4 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . . . 8 8 . . . . . 
    . . . . 8 8 . . . . . . 
    . . . . f f f . . . . . 
    `,img`
    . . . 5 5 5 5 5 5 . . . 
    . . 5 4 4 4 4 5 . . . . 
    . . . 4 4 4 f . . . . . 
    . . . 4 4 4 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 4 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . . . 8 8 . . . . . 
    . . . . . 8 8 . . . . . 
    . . . . 8 8 . . . . . . 
    . . . . f f f . . . . . 
    `,img`
    . . . . 5 5 5 5 5 . . . 
    . . . 5 4 4 4 4 5 . . . 
    . . . . 4 4 4 f . . . . 
    . . . . 4 4 4 4 . . . . 
    . . . . . 7 6 . . . . . 
    . . . . . 6 7 . . . . . 
    . . . . . 4 7 . . . . . 
    . . . . . 8 8 . . . . . 
    . . . . . 8 8 . . . . . 
    . . . . 6 8 8 . . . . . 
    . . . . 6 8 8 . . . . . 
    . . . . e f f f . . . . 
    `,img`
    . . . . 5 5 5 5 5 . . . 
    . . . 5 4 4 4 4 5 . . . 
    . . . . 4 4 4 f . . . . 
    . . . . 4 4 4 4 . . . . 
    . . . . . 7 6 . . . . . 
    . . . . . 6 7 . . . . . 
    . . . . 4 7 7 . . . . . 
    . . . . . 8 8 . . . . . 
    . . . . 6 8 8 8 . . . . 
    . . . 6 6 6 8 8 8 . . . 
    . . . e e . . 8 f f . . 
    . . . . e e . f f . . . 
    `]
animationPullOutGlider = [img`
    . . . 5 5 5 5 5 5 . . . 
    . . 5 4 4 4 4 5 . . . . 
    . . . 4 4 4 f . . . . . 
    . . . 4 4 4 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 4 . . . . . . 
    . . . . 7 e . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . 6 8 8 8 . . . . . 
    . . 6 6 6 8 8 8 . . . . 
    . . e e . . 8 f f . . . 
    . . . e e . f f . . . . 
    . . . . . . . . . . . . 
    . . . . . . . . . . . . 
    . . . . . . . . . . . . 
    . . . . . . . . . . . . 
    `,img`
    . . . 5 5 5 5 5 5 . . . 
    . . 5 4 4 4 4 5 . . . . 
    . . . 4 4 4 f . . . . . 
    . . . 4 4 4 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 4 . . . . . . 
    . . . . 8 e . . . . . . 
    . . . 6 8 8 8 . . . . . 
    . . 6 6 6 8 8 8 . . . . 
    . . e e . . 8 f f . . . 
    . . . e e . f f . . . . 
    . . . . . . . . . . . . 
    . . . . . . . . . . . . 
    . . . . . . . . . . . . 
    . . . . . . . . . . . . 
    `,img`
    . . . . . . . . . . . . 
    . . . 5 5 5 5 5 5 . . . 
    . . 5 4 4 4 4 5 . . . . 
    . . . 4 4 4 f . . . . . 
    . . . 4 4 4 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 6 7 . . . . . . 
    . . . 6 7 7 . . . . . . 
    . e 4 . 8 8 . . . . . . 
    . . e 6 8 8 8 . . . . . 
    . . 6 6 6 8 8 8 . . . . 
    . . e e . . 8 f f . . . 
    . . . e e . f f . . . . 
    . . . . . . . . . . . . 
    . . . . . . . . . . . . 
    . . . . . . . . . . . . 
    `,img`
    . . . . . . . . . . . . 
    . . . 5 5 5 5 5 5 . . . 
    . . 5 4 4 4 4 5 . . . . 
    . . . 4 4 4 f . . . . . 
    . . . 4 4 4 4 . . . . . 
    e 4 6 6 6 6 . . . . . . 
    e e . . 7 7 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . 6 8 8 8 . . . . . 
    . . 6 6 6 8 8 8 . . . . 
    . . e e . . 8 f f . . . 
    . . . e e . f f . . . . 
    . . . . . . . . . . . . 
    . . . . . . . . . . . . 
    `,img`
    . . . . . . . . . . . . 
    e e . . . . . . . . . . 
    e e . . . . . . . . . . 
    e 4 . 5 5 5 5 5 5 . . . 
    . . 6 4 4 4 4 5 . . . . 
    . . . 6 4 4 f . . . . . 
    . . . 4 6 4 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . 6 8 8 8 . . . . . 
    . . 6 6 6 8 8 8 . . . . 
    . . e e . . 8 f f . . . 
    . . . e e . f f . . . . 
    . . . . . . . . . . . . 
    `,img`
    . . . . d d d d d . . . 
    f . . e e e e e e d d d 
    . f f . . e . . . e e e 
    f . . . . 4 . . . . . . 
    . . . 5 5 6 5 5 5 . . . 
    . . 5 4 4 6 4 5 . . . . 
    . . . 4 4 6 f . . . . . 
    . . . 4 4 6 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . 6 8 8 8 . . . . . 
    . . 6 6 6 8 8 8 . . . . 
    . . e e . . 8 f f . . . 
    . . . e e . f f . . . . 
    `]
let animationGliding = [img`
    . . . . d d d d d . . . 
    f . . e e e e e e d d d 
    . f f . . e . . . e e e 
    f . . . . 4 . . . . . . 
    . . . 5 5 6 5 5 5 . . . 
    . . 5 4 4 6 4 5 . . . . 
    . . . 4 4 6 f . . . . . 
    . . . 4 4 6 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . 6 8 8 8 . . . . . 
    . . 6 6 6 8 8 8 . . . . 
    . . e e . . 8 f f . . . 
    . . . e e . f f . . . . 
    `,img`
    . . . . d d d d d . . . 
    . . . e e e e e e d d d 
    f f f . . e . . . e e e 
    . . . . . 4 . . . . . . 
    . . . 5 5 6 5 5 5 . . . 
    . . 5 4 4 6 4 5 . . . . 
    . . . 4 4 6 f . . . . . 
    . . . 4 4 6 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . 6 8 8 8 . . . . . 
    . . 6 6 6 8 8 8 . . . . 
    . . e e . . 8 f f . . . 
    . . . e e . f f . . . . 
    `,img`
    . . . . d d d d d . . . 
    f . . e e e e e e d d d 
    f f f . . e . . . e e e 
    . . . . . 4 . . . . . . 
    . . . 5 5 6 5 5 5 . . . 
    . . 5 4 4 6 4 5 . . . . 
    . . . 4 4 6 f . . . . . 
    . . . 4 4 6 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . 6 8 8 8 . . . . . 
    . . 6 6 6 8 8 8 . . . . 
    . . e e . . 8 f f . . . 
    . . . e e . f f . . . . 
    `,img`
    f . . . d d d d d . . . 
    f f . e e e e e e d d d 
    . . f . . e . . . e e e 
    . . . . . 4 . . . . . . 
    . . . 5 5 6 5 5 5 . . . 
    . . 5 4 4 6 4 5 . . . . 
    . . . 4 4 6 f . . . . . 
    . . . 4 4 6 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . 6 8 8 8 . . . . . 
    . . 6 6 6 8 8 8 . . . . 
    . . e e . . 8 f f . . . 
    . . . e e . f f . . . . 
    `,img`
    . . . . d d d d d . . . 
    . . . e e e e e e d d d 
    f f f . . e . . . e e e 
    f . . . . 4 . . . . . . 
    . . . 5 5 6 5 5 5 . . . 
    . . 5 4 4 6 4 5 . . . . 
    . . . 4 4 6 f . . . . . 
    . . . 4 4 6 4 . . . . . 
    . . . . 7 6 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 7 7 . . . . . . 
    . . . . 8 8 . . . . . . 
    . . . 6 8 8 8 . . . . . 
    . . 6 6 6 8 8 8 . . . . 
    . . e e . . 8 f f . . . 
    . . . e e . f f . . . . 
    `]
let animations = [
animationWalking,
animationJumping,
animationPullOutGlider,
animationGliding
]
tiles.setCurrentTilemap(tileUtil.createSmallMap(tilemap`level1`))
tiles.placeOnTile(mySprite, tiles.getTileLocation(11, 151))
mySprite.ay = 500
for (let value of tiles.getTilesByType(assets.tile`myTile9`)) {
    tileImg = img`
        . 7 7 7 7 7 7 . 
        7 7 7 7 7 7 7 7 
        7 7 7 7 7 7 7 7 
        7 7 7 7 7 7 7 7 
        7 7 7 7 7 7 7 7 
        7 7 7 7 7 7 7 7 
        7 7 7 7 7 7 7 7 
        . 7 7 7 7 7 7 . 
        `
    tiles.setTileAt(tiles.getTileLocation(value.column, value.row), tileImg)
}
allConnections = []
loadMap()
game.onUpdate(function () {
    for (let value of sprites.allOfKind(SpriteKind.Enemy)) {
        if (value.isHittingTile(CollisionDirection.Left)) {
            animation.runImageAnimation(
            value,
            [img`
                . . . . . . . . . . . 7 7 7 7 . 
                . . . . . . . . . . 7 7 7 7 7 7 
                . . . . . . . . . . 7 7 7 7 f 7 
                . . . . . . . . . . 7 7 7 7 7 7 
                . . . . . . . . . . 7 7 7 7 1 1 
                . . . . . . . . . . . 7 7 7 7 . 
                . 6 . . . . . . . . . . 7 7 . . 
                . 7 . . . . . . . . . . 7 7 . . 
                . 7 . . . . . . . 6 . 7 7 7 . . 
                . 7 7 . 6 . . 6 . 7 7 7 7 7 . 7 
                . . 7 7 7 . . 7 7 7 7 7 7 . 7 . 
                . . . 7 7 7 7 7 7 7 7 7 7 . . 7 
                . . . . 7 7 7 7 7 7 7 7 . . . . 
                . . . . . . . 7 7 . . . . . . . 
                . . . . . . . 7 7 . . . . . . . 
                . . . . . . . 7 7 7 . . . . . . 
                `,img`
                . . . . . . . . . . . 7 7 7 7 . 
                . . . . . . . . . . 7 7 7 7 7 7 
                . . . . . . . . . . 7 7 7 7 f 7 
                . . . . . . . . . . 7 7 7 7 7 7 
                . . . . . . . . . . 7 7 7 7 1 1 
                . . . . . . . . . . . 7 7 7 7 . 
                . 6 . . . . . . . . . . 7 7 . . 
                . 7 . . . . . . . . . . 7 7 . . 
                . 7 . . . . . . . 6 . 7 7 7 . . 
                . 7 7 . 6 . . 6 . 7 7 7 7 7 . 7 
                . . 7 7 7 . . 7 7 7 7 7 7 . 7 . 
                . . . 7 7 7 7 7 7 7 7 7 7 . . 7 
                . . . . 7 7 7 7 7 7 7 7 . . . . 
                . . . . . . 6 6 7 7 . . . . . . 
                . . . . . 6 6 . 7 7 . 7 . . . . 
                . . . . . 6 6 6 . 7 7 . . . . . 
                `,img`
                . . . . . . . . . . . 7 7 7 7 . 
                . . . . . . . . . . 7 7 7 7 7 7 
                . . . . . . . . . . 7 7 7 7 f 7 
                . . . . . . . . . . 7 7 7 7 7 7 
                . . . . . . . . . . 7 7 7 7 1 1 
                . . . . . . . . . . . 7 7 7 7 . 
                . 6 . . . . . . . . . . 7 7 . . 
                . 7 . . . . . . . . . . 7 7 . . 
                . 7 . . . . . . . 6 . 7 7 7 . . 
                . 7 7 . 6 . . 6 . 7 7 7 7 7 . 7 
                . . 7 7 7 . . 7 7 7 7 7 7 . 7 . 
                . . . 7 7 7 7 7 7 7 7 7 7 . . 7 
                . . . . 7 7 7 7 7 7 7 7 . . . . 
                . . . . . . . 7 7 . . . . . . . 
                . . . . . . . 7 7 . . . . . . . 
                . . . . . . . 7 7 7 . . . . . . 
                `,img`
                . . . . . . . . . . . 7 7 7 7 . 
                . . . . . . . . . . 7 7 7 7 7 7 
                . . . . . . . . . . 7 7 7 7 f 7 
                . . . . . . . . . . 7 7 7 7 7 7 
                . . . . . . . . . . 7 7 7 7 1 1 
                . . . . . . . . . . . 7 7 7 7 . 
                . 6 . . . . . . . . . . 7 7 . . 
                . 7 . . . . . . . . . . 7 7 . . 
                . 7 . . . . . . . 6 . 7 7 7 . . 
                . 7 7 . 6 . . 6 . 7 7 7 7 7 . 7 
                . . 7 7 7 . . 7 7 7 7 7 7 . 7 . 
                . . . 7 7 7 7 7 7 7 7 7 7 . . 7 
                . . . . 7 7 7 7 7 7 7 7 . . . . 
                . . . . . . 7 7 6 6 . . . . . . 
                . . . . . 7 7 . 6 6 . 6 . . . . 
                . . . . . 7 7 7 . 6 6 . . . . . 
                `],
            500,
            true
            )
            value.vx = 10
        } else if (value.isHittingTile(CollisionDirection.Right)) {
            animation.runImageAnimation(
            value,
            [img`
                . 7 7 7 7 . . . . . . . . . . . 
                7 7 7 7 7 7 . . . . . . . . . . 
                7 f 7 7 7 7 . . . . . . . . . . 
                7 7 7 7 7 7 . . . . . . . . . . 
                1 1 7 7 7 7 . . . . . . . . . . 
                . 7 7 7 7 . . . . . . . . . . . 
                . . 7 7 . . . . . . . . . . 6 . 
                . . 7 7 . . . . . . . . . . 7 . 
                . . 7 7 7 . 6 . . . . . . . 7 . 
                7 . 7 7 7 7 7 . 6 . . 6 . 7 7 . 
                . 7 . 7 7 7 7 7 7 . . 7 7 7 . . 
                7 . . 7 7 7 7 7 7 7 7 7 7 . . . 
                . . . . 7 7 7 7 7 7 7 7 . . . . 
                . . . . . . . 7 7 . . . . . . . 
                . . . . . . . 7 7 . . . . . . . 
                . . . . . . 7 7 7 . . . . . . . 
                `,img`
                . 7 7 7 7 . . . . . . . . . . . 
                7 7 7 7 7 7 . . . . . . . . . . 
                7 f 7 7 7 7 . . . . . . . . . . 
                7 7 7 7 7 7 . . . . . . . . . . 
                1 1 7 7 7 7 . . . . . . . . . . 
                . 7 7 7 7 . . . . . . . . . . . 
                . . 7 7 . . . . . . . . . . 6 . 
                . . 7 7 . . . . . . . . . . 7 . 
                . . 7 7 7 . 6 . . . . . . . 7 . 
                7 . 7 7 7 7 7 . 6 . . 6 . 7 7 . 
                . 7 . 7 7 7 7 7 7 . . 7 7 7 . . 
                7 . . 7 7 7 7 7 7 7 7 7 7 . . . 
                . . . . 7 7 7 7 7 7 7 7 . . . . 
                . . . . . . 7 7 6 6 . . . . . . 
                . . . . 7 . 7 7 . 6 6 . . . . . 
                . . . . . 7 7 . 6 6 6 . . . . . 
                `,img`
                . 7 7 7 7 . . . . . . . . . . . 
                7 7 7 7 7 7 . . . . . . . . . . 
                7 f 7 7 7 7 . . . . . . . . . . 
                7 7 7 7 7 7 . . . . . . . . . . 
                1 1 7 7 7 7 . . . . . . . . . . 
                . 7 7 7 7 . . . . . . . . . . . 
                . . 7 7 . . . . . . . . . . 6 . 
                . . 7 7 . . . . . . . . . . 7 . 
                . . 7 7 7 . 6 . . . . . . . 7 . 
                7 . 7 7 7 7 7 . 6 . . 6 . 7 7 . 
                . 7 . 7 7 7 7 7 7 . . 7 7 7 . . 
                7 . . 7 7 7 7 7 7 7 7 7 7 . . . 
                . . . . 7 7 7 7 7 7 7 7 . . . . 
                . . . . . . . 7 7 . . . . . . . 
                . . . . . . . 7 7 . . . . . . . 
                . . . . . . 7 7 7 . . . . . . . 
                `,img`
                . 7 7 7 7 . . . . . . . . . . . 
                7 7 7 7 7 7 . . . . . . . . . . 
                7 f 7 7 7 7 . . . . . . . . . . 
                7 7 7 7 7 7 . . . . . . . . . . 
                1 1 7 7 7 7 . . . . . . . . . . 
                . 7 7 7 7 . . . . . . . . . . . 
                . . 7 7 . . . . . . . . . . 6 . 
                . . 7 7 . . . . . . . . . . 7 . 
                . . 7 7 7 . 6 . . . . . . . 7 . 
                7 . 7 7 7 7 7 . 6 . . 6 . 7 7 . 
                . 7 . 7 7 7 7 7 7 . . 7 7 7 . . 
                7 . . 7 7 7 7 7 7 7 7 7 7 . . . 
                . . . . 7 7 7 7 7 7 7 7 . . . . 
                . . . . . . 6 6 7 7 . . . . . . 
                . . . . 6 . 6 6 . 7 7 . . . . . 
                . . . . . 6 6 . 7 7 7 . . . . . 
                `],
            500,
            true
            )
            value.vx = -10
        }
    }
    if (rune == 0) {
        controller.moveSprite(mySprite, 100, 0)
        if (controller.right.isPressed() && direction == 1 || controller.left.isPressed() && direction == 0) {
            for (let index = 0; index <= animations.length - 1; index++) {
                for (let value of animations[index]) {
                    value.flipX()
                }
            }
            direction = (direction + 1) % 2
        }
        if ((controller.left.isPressed() || controller.right.isPressed()) && mySprite.isHittingTile(CollisionDirection.Bottom)) {
            timer.throttle("a1", 50 * animationWalking.length, function () {
                animation.runImageAnimation(
                mySprite,
                animationWalking,
                50,
                false
                )
            })
        }
        if (mySprite.isHittingTile(CollisionDirection.Bottom)) {
            if (inAir == 1) {
                mySprite.setImage(img`
                    . . . 5 5 5 5 5 5 . . . 
                    . . 5 4 4 4 4 5 . . . . 
                    . . . 4 4 4 f . . . . . 
                    . . . 4 4 4 4 . . . . . 
                    . . . . 7 6 . . . . . . 
                    . . . . 7 6 . . . . . . 
                    . . . . 7 4 . . . . . . 
                    . . . . 7 7 . . . . . . 
                    . . . . 8 8 . . . . . . 
                    . . . . 8 8 . . . . . . 
                    . . . . 8 8 . . . . . . 
                    . . . . f f f . . . . . 
                    `)
                if (direction == 1) {
                    mySprite.image.flipX()
                }
            }
            if (gliding == 1) {
                mySprite.y += 4
                animation.stopAnimation(animation.AnimationTypes.All, mySprite)
            }
            gliding = 0
            inAir = 0
        } else {
            inAir = 1
        }
        if (gliding == 1) {
            timer.throttle("a2", 100 * animationGliding.length, function () {
                animation.runImageAnimation(
                mySprite,
                animationGliding,
                100,
                false
                )
            })
            if (mySprite.vy > 15) {
                mySprite.vy = 15
            }
            controller.moveSprite(mySprite, 125, 0)
        }
    } else if (rune == 1) {
        controller.moveSprite(mySprite, 0, 0)
        if (holdingState == 0) {
            if (controller.A.isPressed()) {
                for (let value of sprites.allOfKind(SpriteKind.physicsObject)) {
                    if (cursor.overlapsWith(value)) {
                        pauseUntil(() => !(controller.A.isPressed()))
                        holdingState = 1
                        value.setFlag(SpriteFlag.StayInScreen, true)
                        holdObject(value)
                        break;
                    }
                }
            }
        }
    } else {
    	
    }
    velocityChangeX = 0
    velocityChangeY = 0
    for (let value of allConnections) {
        for (let value2 of value) {
            if (sprites.readDataString(value2, "type") == "controller (occupied)") {
                for (let value3 of value) {
                    if (sprites.readDataString(value3, "type") == "fan") {
                        velocityChangeX += Math.cos(spriteutils.degreesToRadians(transformSprites.getRotation(value3) - 90)) * 0.5
                        velocityChangeY += Math.sin(spriteutils.degreesToRadians(transformSprites.getRotation(value3) - 90)) * 0.5
                        if (Math.percentChance((Math.abs(velocityChangeX) + Math.abs(velocityChangeY)) * 3)) {
                            particle = sprites.createProjectileFromSprite(img`
                                . . . . 1 . . . . 
                                . . . . 1 . . . . 
                                . . . . 1 . . . . 
                                . . . . 1 . . . . 
                                . . . . 1 . . . . 
                                . . . . 1 . . . . 
                                . . . . 1 . . . . 
                                . . . . 1 . . . . 
                                . . . . 1 . . . . 
                                `, value3, 0 - velocityChangeX, 0 - velocityChangeY)
                            particle.setKind(SpriteKind.FanGust)
                            transformSprites.rotateSprite(particle, transformSprites.getRotation(value3))
                            particle.x += (0 - velocityChangeX) * 4 + randint(-5, 5)
                            particle.y += (0 - velocityChangeY) * 4 + randint(-5, 5)
                            particle.lifespan = 500
                            particle.setFlag(SpriteFlag.AutoDestroy, true)
                        }
                    }
                    if (sprites.readDataString(value3, "type") == "rocket") {
                        velocityChangeX += Math.cos(spriteutils.degreesToRadians(transformSprites.getRotation(value3) - 90)) * 4
                        velocityChangeY += Math.sin(spriteutils.degreesToRadians(transformSprites.getRotation(value3) - 90)) * 4
                        if (Math.percentChance((Math.abs(velocityChangeX) + Math.abs(velocityChangeY)) * 8)) {
                            particle = sprites.createProjectileFromSprite(img`
                                f 
                                `, value3, 0 - velocityChangeX, 0 - velocityChangeY)
                            transformSprites.rotateSprite(particle, transformSprites.getRotation(value3))
                            particle.x += (0 - velocityChangeX) * 4 + randint(-2, 2)
                            particle.y += (0 - velocityChangeY) * 4 + randint(-2, 2)
                            particle.lifespan = 500
                        }
                    }
                    if (sprites.readDataString(value3, "type") == "wheel") {
                        if (tiles.tileAtLocationIsWall(tiles.getTileLocation(value3.tilemapLocation().column + Math.constrain(Math.cos(spriteutils.degreesToRadians(transformSprites.getRotation(value3) + 70)) * 9, -1.5, 1.5), value3.tilemapLocation().row + Math.constrain(Math.sin(spriteutils.degreesToRadians(transformSprites.getRotation(value3) + 70)) * 9, -1.5, 1.5))) || tiles.tileAtLocationIsWall(tiles.getTileLocation(value3.tilemapLocation().column + Math.constrain(Math.cos(spriteutils.degreesToRadians(transformSprites.getRotation(value3) + 110)) * 9, -1.5, 1.5), value3.tilemapLocation().row + Math.constrain(Math.sin(spriteutils.degreesToRadians(transformSprites.getRotation(value3) + 110)) * 9, -1.5, 1.5)))) {
                            console.log(Math.cos(spriteutils.degreesToRadians(transformSprites.getRotation(value3) + 70)))
                            if (transformSprites.getRotation(value3) < 0) {
                                for (let index = 0; index <= Math.ceil((0 - transformSprites.getRotation(value3)) / 360); index++) {
                                    transformSprites.changeRotation(value3, 360)
                                }
                            }
                            transformSprites.rotateSprite(value3, transformSprites.getRotation(value3) % 360)
                            if ((transformSprites.getRotation(value3) < 90 || transformSprites.getRotation(value3) > 270) && (tiles.tileAtLocationIsWall(tiles.getTileLocation(value3.x / 8, (value3.bottom + 1) / 8)) || (tiles.tileAtLocationIsWall(tiles.getTileLocation((value3.left - 1) / 8, (value3.bottom + 1) / 8)) || tiles.tileAtLocationIsWall(tiles.getTileLocation((value3.right + 1) / 8, (value3.bottom + 1) / 8))))) {
                                if (controller.left.isPressed()) {
                                    velocityChangeX += Math.cos(spriteutils.degreesToRadians(transformSprites.getRotation(value3) - 180)) * 2
                                } else if (controller.right.isPressed()) {
                                    velocityChangeX += Math.cos(spriteutils.degreesToRadians(transformSprites.getRotation(value3))) * 2
                                }
                            } else if (transformSprites.getRotation(value3) > 90 && transformSprites.getRotation(value3) < 270 && (tiles.tileAtLocationIsWall(tiles.getTileLocation(value3.x / 8, (value3.top - 1) / 8)) || (tiles.tileAtLocationIsWall(tiles.getTileLocation((value3.left - 1) / 8, (value3.top - 1) / 8)) || tiles.tileAtLocationIsWall(tiles.getTileLocation((value3.right + 1) / 8, (value3.top - 1) / 8))))) {
                                if (controller.left.isPressed()) {
                                    velocityChangeX += Math.cos(spriteutils.degreesToRadians(transformSprites.getRotation(value3))) * 2
                                } else if (controller.right.isPressed()) {
                                    velocityChangeX += Math.cos(spriteutils.degreesToRadians(transformSprites.getRotation(value3) - 180)) * 2
                                }
                            }
                            if (transformSprites.getRotation(value3) > 0 && transformSprites.getRotation(value3) < 180 && (tiles.tileAtLocationIsWall(tiles.getTileLocation((value3.left - 1) / 8, value3.y / 8)) || (tiles.tileAtLocationIsWall(tiles.getTileLocation((value3.left - 1) / 8, (value3.top - 1) / 8)) || tiles.tileAtLocationIsWall(tiles.getTileLocation((value3.left - 1) / 8, (value3.bottom + 1) / 8))))) {
                                if (controller.up.isPressed()) {
                                    velocityChangeY += Math.sin(spriteutils.degreesToRadians(transformSprites.getRotation(value3) - 180)) * 2
                                } else if (controller.down.isPressed()) {
                                    velocityChangeY += Math.sin(spriteutils.degreesToRadians(transformSprites.getRotation(value3))) * 2
                                }
                            } else if (transformSprites.getRotation(value3) > 180 && transformSprites.getRotation(value3) < 360 && (tiles.tileAtLocationIsWall(tiles.getTileLocation((value3.right + 1) / 8, value3.y / 8)) || (tiles.tileAtLocationIsWall(tiles.getTileLocation((value3.right + 1) / 8, (value3.top - 1) / 8)) || tiles.tileAtLocationIsWall(tiles.getTileLocation((value3.right + 1) / 8, (value3.bottom + 1) / 8))))) {
                                if (controller.up.isPressed()) {
                                    velocityChangeY += Math.sin(spriteutils.degreesToRadians(transformSprites.getRotation(value3))) * 2
                                } else if (controller.down.isPressed()) {
                                    velocityChangeY += Math.sin(spriteutils.degreesToRadians(transformSprites.getRotation(value3) - 180)) * 2
                                }
                            }
                        }
                    }
                }
                velocityChangeX = velocityChangeX / (value.length / 5)
                velocityChangeY = velocityChangeY / (value.length / 5)
            }
        }
    }
    if (rune == 0) {
        for (let value of allConnections) {
            for (let value2 of value) {
                if (controller.A.isPressed() && (sprites.readDataString(value2, "type") == "controller (empty)" && spriteutils.distanceBetween(mySprite, value2) < 25)) {
                    pauseUntil(() => !(controller.A.isPressed()))
                    mounted = true
                    sprites.setDataString(value2, "type", "controller (occupied)")
                    sprites.destroyAllSpritesOfKind(SpriteKind.Projectile)
                }
                if (sprites.readDataString(value2, "type") == "controller (occupied)") {
                    if (controller.A.isPressed()) {
                        pauseUntil(() => !(controller.A.isPressed()))
                        mounted = false
                        sprites.setDataString(value2, "type", "controller (empty)")
                        transformSprites.rotateSprite(mySprite, 0)
                    } else {
                        gliding = 0
                        mySprite.vy = 0
                        animation.stopAnimation(animation.AnimationTypes.All, mySprite)
                        mySprite.setImage(img`
                            . . . 5 5 5 5 5 5 . . . 
                            . . 5 4 4 4 4 5 . . . . 
                            . . . 4 4 4 f . . . . . 
                            . . . 4 4 4 4 . . . . . 
                            . . . . 7 6 . . . . . . 
                            . . . . 7 6 . . . . . . 
                            . . . . 7 4 . . . . . . 
                            . . . . 7 7 . . . . . . 
                            . . . . 8 8 . . . . . . 
                            . . . . 8 8 . . . . . . 
                            . . . . 8 8 . . . . . . 
                            . . . . f f f . . . . . 
                            `)
                        if (direction == 1) {
                            mySprite.image.flipX()
                        }
                    }
                }
            }
        }
        if (mySprite.tileKindAt(TileDirection.Right, assets.tile`myTile39`) && blockSettings.readNumber("finalBossComplete") == 0) {
            for (let value of tiles.getTilesByType(assets.tile`myTile39`)) {
                tiles.setTileAt(value, assets.tile`myTile40`)
                tiles.setWallAt(value, true)
                for (let value of tiles.getTilesByType(assets.tile`myTile47`)) {
                    boss = sprites.create(img`
                        .............f4.............
                        ............f44.............
                        .22222......f44.........22..
                        2222222.....f44........2222.
                        2112222..f.f444......f.2222.
                        2f122222f22f444.......f2222.
                        2222222222f4444..f..f222222.
                        2222222222f44442f2.2f22222..
                        .ff2222222f44422222222222...
                        ....222222f4442222222222....
                        ....2222222222222222222.....
                        .....222222222222222........
                        ......22222222222...........
                        .......2.....2..............
                        ......22....22..............
                        ......2.....2...............
                        .....2.2...2.2..............
                        ............................
                        `, SpriteKind.boss)
                    bossAnimation = [img`
                        .............f4.............
                        ............f44.............
                        .22222......f44.........22..
                        2222222.....f44........2222.
                        2112222..f.f444......f.2222.
                        2f122222f22f444.......f2222.
                        2222222222f4444..f..f222222.
                        2222222222f44442f2.2f22222..
                        .ff2222222f44422222222222...
                        ....222222f4442222222222....
                        ....2222222222222222222.....
                        .....222222222222222........
                        ......22222222222...........
                        .......2.....2..............
                        ......22....22..............
                        ......2.....2...............
                        .....2.2...2.2..............
                        ............................
                        `,img`
                        ............................
                        ............................
                        .22222..................22..
                        2222222................2222.
                        2112222..f...........f.2222.
                        2f122222f22...........f2222.
                        222222222222.....f..f222222.
                        2222222222222f42f2.2f22222..
                        .ff22222222ff442222222222...
                        ....222222f4444222222222....
                        ....2222222222222222222.....
                        .....222222222222222........
                        ......22222222222...........
                        .......2.....2..............
                        ......22....22..............
                        ......2.....2...............
                        .....2.2...2.2..............
                        ............................
                        `,img`
                        ............................
                        ............................
                        .22222......................
                        2222222..................22.
                        2112222..f...........f..2222
                        2f122222f22...........f22222
                        222222222222.....f..f222222.
                        2222222222222222f2.2f22222..
                        .ff2222222222222222222222...
                        ....222222f4442222222222....
                        ....222222f444222222222.....
                        .....22222f444422222........
                        ......2222f444422...........
                        .......2..2f444.............
                        ......22...f444.............
                        ......2.....f44.............
                        .....2.2...2f44.............
                        .............f4.............
                        `,img`
                        ............................
                        ............................
                        .22222..................22..
                        2222222................2222.
                        2112222..f...........f.2222.
                        2f122222f22...........f2222.
                        222222222222.....f..f222222.
                        2222222222222f42f2.2f22222..
                        .ff22222222ff442222222222...
                        ....222222f4444222222222....
                        ....2222222222222222222.....
                        .....222222222222222........
                        ......22222222222...........
                        .......2.....2..............
                        ......22....22..............
                        ......2.....2...............
                        .....2.2...2.2..............
                        ............................
                        `]
                    tiles.placeOnTile(boss, value)
                    tiles.setTileAt(value, assets.tile`transparency8`)
                    sprites.setDataNumber(boss, "health", 10)
                    boss.vx = -50
                }
            }
        }
    }
    if (mySprite.y > 1538 && area == 0) {
        scene.setBackgroundColor(10)
    } else {
        scene.setBackgroundColor(9)
    }
})
game.onUpdate(function () {
    if (rune == 2) {
        scene.setBackgroundImage(img`
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            ................................................................................................................................................................
            `)
        scene.backgroundImage().drawLine(mySprite.x - scene.cameraProperty(CameraProperty.Left), mySprite.y - scene.cameraProperty(CameraProperty.Top), selectedBlock.x - scene.cameraProperty(CameraProperty.Left), selectedBlock.y - scene.cameraProperty(CameraProperty.Top), 8)
        mySprite.ax = selectedBlock.x - mySprite.x
        mySprite.ay = selectedBlock.y - mySprite.y
        mySprite.x += mySprite.ax * 0.03
        mySprite.y += mySprite.ay * 0.03
    }
})
game.onUpdate(function () {
    for (let value of sprites.allOfKind(SpriteKind.GroundFan)) {
        if (Math.percentChance(5)) {
            if (spriteutils.distanceBetween(mySprite, value) < 128) {
                particle = sprites.create(img`
                    . . . . 1 . . . . 
                    . . . . 1 . . . . 
                    . . . . 1 . . . . 
                    . . . . 1 . . . . 
                    . . . . 1 . . . . 
                    . . . . 1 . . . . 
                    . . . . 1 . . . . 
                    . . . . 1 . . . . 
                    . . . . 1 . . . . 
                    `, SpriteKind.FanGust)
                particle.setVelocity(0, -50)
                tiles.placeOnTile(particle, value.tilemapLocation())
                particle.y += -5
                particle.x += randint(-4, 4)
                particle.lifespan = 500
                particle.setFlag(SpriteFlag.AutoDestroy, true)
                particle.setFlag(SpriteFlag.GhostThroughTiles, true)
                particle.setFlag(SpriteFlag.GhostThroughWalls, true)
            }
        }
    }
})
forever(function () {
	
})
